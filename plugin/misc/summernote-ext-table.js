!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/",o(o.s=16)}({0:function(e,t){e.exports=$},16:function(e,t,o){var n,r,a;function l(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function c(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?c(Object(o),!0).forEach((function(t){d(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):c(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function d(e,t,o){return(t=function(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!==u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===u(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r=[o(0)],void 0===(a="function"==typeof(n=function(e){var t=function e(t,o,n,r){var a={colPos:0,rowPos:0},l=[],i=[],c=[];function s(e,t,o,n,r,a,i){var c={baseRow:o,baseCell:n,isRowSpan:r,isColSpan:a,isVirtual:i};l[e]||(l[e]=[]),l[e][t]=c}function d(e,t,o,n){return{baseCell:e.baseCell,action:t,virtualTable:{rowIndex:o,cellIndex:n}}}function u(e,t,o){if(!e[t])return o;if(!e[t][o])return o;for(var n=o;e[t][n];)if(n++,!e[t][n])return n}function b(e,t){var o=u(l,e.rowIndex,t.cellIndex),n=t.colSpan>1,r=t.rowSpan>1,i=e.rowIndex===a.rowPos&&t.cellIndex===a.colPos;s(e.rowIndex,o,e,t,r,n,!1);var c=t.attributes.rowSpan?parseInt(t.attributes.rowSpan.value,10):0;if(c>1)for(var d=1;d<c;d++){var b=e.rowIndex+d;f(b,o,t,i),s(b,o,e,t,!0,n,!0)}var p=t.attributes.colSpan?parseInt(t.attributes.colSpan.value,10):0;if(p>1)for(var g=1;g<p;g++){var v=u(l,e.rowIndex,o+g);f(e.rowIndex,v,t,i),s(e.rowIndex,v,e,t,r,!0,!0)}}function f(e,t,o,n){e===a.rowPos&&a.colPos>=o.cellIndex&&o.cellIndex<=t&&!n&&a.colPos++}function p(t){switch(o){case e.where.Column:if(t.isColSpan)return e.resultAction.SubtractSpanCount;break;case e.where.Row:if(!t.isVirtual&&t.isRowSpan)return e.resultAction.AddCell;if(t.isRowSpan)return e.resultAction.SubtractSpanCount}return e.resultAction.RemoveCell}function g(t){switch(o){case e.where.Column:if(t.isColSpan)return e.resultAction.SumSpanCount;if(t.isRowSpan&&t.isVirtual)return e.resultAction.Ignore;break;case e.where.Row:if(t.isRowSpan)return e.resultAction.SumSpanCount;if(t.isColSpan&&t.isVirtual)return e.resultAction.Ignore}return e.resultAction.AddCell}function v(e,t,o,n,r,a,l){var i={baseRow:o,baseCell:n,isRowSpan:r,isColSpan:a,isVirtual:l};c[e]||(c[e]=[]),c[e][t]=i}function m(e,t){var o=e.rowIndex,n=u(c,e.rowIndex,t.cellIndex),r=t.rowSpan>1,a=t.colSpan>1;v(o,n,e,t,r,a,!1);var l=t.rowSpan,i=t.colSpan;if(a)for(var s=1;s<i;s++)v(o,n+s,e,t,r,a,!0);if(r)for(var d=1;d<l;d++)if(v(o+d,n,e,t,r,a,!0),a)for(var b=1;b<i;b++)v(o+d,n+b,e,t,r,a,!0)}this.getActionList=function(){for(var t=o===e.where.Row?a.rowPos:-1,r=o===e.where.Column?a.colPos:-1,c=0,s=!0;s;){var u=t>=0?t:c,b=r>=0?r:c,f=l[u];if(!f)return s=!1,i;var v=f[b];if(!v)return s=!1,i;var m=e.resultAction.Ignore;switch(n){case e.requestAction.Add:m=g(v);break;case e.requestAction.Delete:m=p(v)}i.push(d(v,m,u,b)),c++}return i},this.getVirtualTable=function(){return l},this.getMatrixTable=function(){return c},this.getColCount=function(){for(var e=0,t=0;t<c.length;t++){var o=c[t];e<=o.length&&(e=o.length)}return e},t&&t.tagName&&("td"===t.tagName.toLowerCase()||"th"===t.tagName.toLowerCase())&&(a.colPos=t.cellIndex,t.parentElement&&t.parentElement.tagName&&"tr"===t.parentElement.tagName.toLowerCase()&&(a.rowPos=t.parentElement.rowIndex)),function(){for(var e=r.rows,t=0;t<e.length;t++)for(var o=e[t].cells,n=0;n<o.length;n++)b(e[t],o[n])}(),function(){for(var e=r.rows,t=0;t<e.length;t++)for(var o=e[t].cells,n=0;n<o.length;n++)m(e[t],o[n])}()};t.where={Row:0,Column:1},t.requestAction={Add:0,Delete:1},t.resultAction={Ignore:0,SubtractSpanCount:1,RemoveCell:2,AddCell:3,SumSpanCount:4},e.extend(!0,e.summernote.options,{jTable:{mergeMode:"drag"}}),e.extend(!0,e.summernote.lang,{"zh-TW":{jTable:{borderColor:"外框顏色",merge:{merge:"合併儲存格",colspan:"欄",rowspan:"列",split:"取消合併儲存格"},align:{top:"靠上對齊",middle:"置中對齊",bottom:"靠下對齊",baseline:"baseline"},info:{info:"table info",margin:"邊界"},apply:"套用",addDeleteRowCOl:"欄/列(插入/刪除)",areaReset:"清除格式",message:"<b>取消合併儲存格才可使用</br>"}},"en-US":{jTable:{borderColor:"Border color",merge:{merge:"cell merge",colspan:"colspan",rowspan:"rowspan",split:"cell split"},align:{top:"top",middle:"middle",bottom:"bottom",baseline:"baseline"},info:{info:"table info",margin:"margin"},apply:"apply",addDeleteRowCOl:"Row/Col(Add/Del)",areaReset:"area Reset",message:"<b>Available after unmerge<br/>current or surrounding cells</br>"}},"ko-KR":{jTable:{borderColor:"선색",merge:{merge:"셀 합치기",colspan:"가로",rowspan:"세로",split:"셀 나누기"},align:{top:"위쪽 정렬",middle:"가운데 정렬",bottom:"아래쪽 정렬",baseline:"기본 정렬"},info:{info:"테이블 정보",margin:"여백"},apply:"적용",addDeleteRowCOl:"행/열(추가/삭제)",areaReset:"넓이/높이 초기화",message:"<b>현재 또는 주위 셀<br/>병합 해제 후 사용 가능</b>"}}}),e.extend(!0,e.summernote,{plugins:{jTable:function(o){var n,r,a=this,i=e.summernote.dom,c=e.summernote.ui,u=o.modules,b=o.options,f=(o.layoutInfo.editable,b.langInfo),p=navigator.userAgent,g=/MSIE|Trident/i.test(p),v=/Edge\/\d+/.test(p),m=(!v&&/firefox/i.test(p),!v&&/firefox/i.test(p),/PhantomJS/i.test(p),!v&&/webkit/i.test(p),!v&&/chrome/i.test(p),!v&&/safari/i.test(p)&&/chrome/i.test(p),{pressed:!1,rightFlag:!1,bottomFlag:!1,currentTableEl:void 0,currentTrEl:void 0,firstTdEl:void 0,colEl:void 0,currentTdEl:void 0,currentTdLeft:void 0,currentTdRight:void 0,currentTdTop:void 0,currentTdBottom:void 0,startX:void 0,startWidth:void 0,startY:void 0,startHeight:void 0,contenteditable:!1}),h={pressed:!1,currentTableEl:void 0,currentTdEl:void 0,currentTdLeft:void 0,currentTdRight:void 0,currentTdTop:void 0,currentTdBottom:void 0,currentTdPosition:{row:void 0,col:void 0},width:void 0,height:void 0,top:void 0,left:void 0,effect:{row:{start:void 0,end:void 0},col:{start:void 0,end:void 0}}},w=[c.button({className:"btn-md",contents:c.icon(b.icons.rowAbove),tooltip:f.table.addRowAbove,container:b.container,click:o.createInvokeHandler("jTable.jAddRow","top")}),c.button({className:"btn-md",contents:c.icon(b.icons.rowBelow),tooltip:f.table.addRowBelow,container:b.container,click:o.createInvokeHandler("jTable.jAddRow","bottom")}),c.button({className:"btn-md",contents:c.icon(b.icons.colBefore),tooltip:f.table.addColLeft,container:b.container,click:o.createInvokeHandler("jTable.jAddCol","left")}),c.button({className:"btn-md",contents:c.icon(b.icons.colAfter),tooltip:f.table.addColRight,container:b.container,click:o.createInvokeHandler("jTable.jAddCol","right")})],C=[c.button({className:"btn-md",contents:c.icon(b.icons.rowRemove),tooltip:f.table.delRow,container:b.container,click:o.createInvokeHandler("jTable.jDeleteRow")}),c.button({className:"btn-md",contents:c.icon(b.icons.colRemove),tooltip:f.table.delCol,container:b.container,click:o.createInvokeHandler("jTable.jDeleteCol")})];a.recoverPopover=function(t){var o=e(t.target).closest("button"),n=o.closest(".dropdown-toggle"),r=u.editor.getLastRange.call(u.editor),a=i.ancestor(r.commonAncestor(),i.isCell);if(o.closest(".popover").length){var l=o.closest(".popover").css("left"),c=o.closest(".popover").css("top"),s=o.outerHeight();setTimeout((function(){u.tablePopover.update(a);var e=o.closest(".popover"),t=n.next(".dropdown-menu");e.css({left:l,top:c}),t.css({transform:"translate3d(0px, ".concat(s,"px, 0px)")})}),0)}},o.memo("button.jAddDeleteRowCol",(function(){return c.buttonGroup({className:"jtable-add-del-row-col jtable-display",children:[c.button({className:"dropdown-toggle",contents:c.dropdownButtonContents(c.icon(b.icons.rowAbove),b),tooltip:f.jTable.addDeleteRowCOl,container:b.container,data:{toggle:"dropdown"},click:function(o){var n=e(this).closest(".jtable-add-del-row-col"),r=n.find(".btn-md"),l=!1,c=u.editor.getLastRange.call(u.editor);if(c.isCollapsed()&&c.isOnCell()){var s=i.ancestor(c.commonAncestor(),i.isCell);if(!(l=s.rowSpan>1||s.colSpan>1)){for(var d=e(s).closest("table"),b=e(s).closest("tr")[0].rowIndex,f=new t(s,void 0,void 0,d[0]).getMatrixTable(),p=f[b],g=0,v=0;v<p.length;v++)(h=p[v]).isVirtual||s!=h.baseCell||(g=v),(h.baseCell.colSpan>1||h.baseCell.rowSpan>1)&&(l=!0);for(var m=0;m<f.length;m++){var h;((h=f[m][g]).baseCell.colSpan>1||h.baseCell.rowSpan>1)&&(l=!0)}}}r.toggleClass("disabled",l),r.attr("disabled",l);var w=n.find(".jtable-add-row-col-button-group, .jtable-del-row-col-button-group"),C=n.find(".jtable-dropdown-message"),j=n.find(".jtable-add-del-row-col-dropdown");l?(w.hide(),C.show()):(w.show(),C.hide(),j.css("width","")),a.recoverPopover(o)}}),c.dropdown({className:"jtable-add-del-row-col-dropdown",children:[c.button({className:"jtable-dropdown-message",contents:f.jTable.message,container:b.container}),c.buttonGroup({className:"jtable-add-row-col-button-group",children:w}),c.buttonGroup({className:"jtable-del-row-col-button-group",children:C})]})]}).render()})),a.jAddRow=function(e){var t=u.editor.getLastRange.call(u.editor);if(t.isCollapsed()&&t.isOnCell()){a.beforeCommand();var o=i.ancestor(t.commonAncestor(),i.isCell);a.addRow(o,e),a.afterCommand()}},a.addRow=function(o,n){for(var r=e(o).closest("tr"),l=a.recoverAttributes(r),c=e("<tr"+l+"></tr>"),s=new t(o,t.where.Row,t.requestAction.Add,e(r).closest("table")[0]).getActionList(),d=0;d<s.length;d++){var u=s[d],b=a.recoverAttributes(u.baseCell);switch(u.action){case t.resultAction.AddCell:c.append("<td"+b+">"+i.blank+"</td>");break;case t.resultAction.SumSpanCount:if("top"===n&&(u.baseCell.parent?u.baseCell.closest("tr").rowIndex:0)<=r[0].rowIndex){var f=e("<div></div>").append(e("<td"+b+">"+i.blank+"</td>").removeAttr("rowspan")).html();c.append(f);break}var p=parseInt(u.baseCell.rowSpan,10);p++,u.baseCell.setAttribute("rowSpan",p)}}if("top"===n)r.before(c);else{if(o.rowSpan>1){var g=r[0].rowIndex+(o.rowSpan-2);return void e(e(r).parent().find("tr")[g]).after(e(c))}r.after(c)}},a.jAddCol=function(e){var t=u.editor.getLastRange.call(u.editor);if(t.isCollapsed()&&t.isOnCell()){a.beforeCommand();var o=i.ancestor(t.commonAncestor(),i.isCell);a.addCol(o,e),a.afterCommand()}},a.addCol=function(o,n){for(var r=e(o).closest("tr"),l=e(r).closest("table").find("colgroup").children("col"),c=r.children().index(e(o)),s=new t(o,t.where.Column,t.requestAction.Add,e(r).closest("table")[0]).getActionList(),d=0;d<s.length;d++){var u=s[d],b=a.recoverAttributes(u.baseCell);switch(u.action){case t.resultAction.AddCell:"right"===n?e(u.baseCell).after("<td"+b+">"+i.blank+"</td>"):e(u.baseCell).before("<td"+b+">"+i.blank+"</td>");break;case t.resultAction.SumSpanCount:var f=parseInt(u.baseCell.colSpan,10);f++,u.baseCell.setAttribute("colSpan",f)}}if(l.length){for(var p=0;p<l.length;p++){var g=l[p],v=g.span;for(g.span=1;v>1;)e(g).after(e(g).prop("outerHTML")),v-=1}var m=l[c],h=a.recoverAttributes(m),w=e("<col"+h+"/>");w.width(100),"right"===n?e(m).after(w[0]):e(m).before(w[0])}},a.jDeleteRow=function(){var o=u.editor.getLastRange.call(u.editor);if(o.isCollapsed()&&o.isOnCell()){a.beforeCommand();for(var n=i.ancestor(o.commonAncestor(),i.isCell),r=e(n).closest("tr"),l=r.children("td, th").index(e(n)),c=r[0].rowIndex,s=new t(n,t.where.Row,t.requestAction.Delete,e(r).closest("table")[0]).getActionList(),d=0;d<s.length;d++)if(s[d]){var b=s[d].baseCell,f=s[d].virtualTable,p=b.rowSpan&&b.rowSpan>1,g=p?parseInt(b.rowSpan,10):0;switch(s[d].action){case t.resultAction.Ignore:continue;case t.resultAction.AddCell:var v=r.next("tr")[0];if(!v)continue;var m=r[0].cells[l];p&&(g>2?(g--,v.insertBefore(m,v.cells[l]),v.cells[l].setAttribute("rowSpan",g),v.cells[l].innerHTML=""):2===g&&(v.insertBefore(m,v.cells[l]),v.cells[l].removeAttribute("rowSpan"),v.cells[l].innerHTML=""));continue;case t.resultAction.SubtractSpanCount:p&&(g>2?(g--,b.setAttribute("rowSpan",g),f.rowIndex!==c&&b.cellIndex===l&&(b.innerHTML="")):2===g&&(b.removeAttribute("rowSpan"),f.rowIndex!==c&&b.cellIndex===l&&(b.innerHTML="")));continue;case t.resultAction.RemoveCell:continue}}r.remove(),a.afterCommand()}},a.jDeleteCol=function(){var o=u.editor.getLastRange.call(u.editor);if(o.isCollapsed()&&o.isOnCell()){a.beforeCommand();for(var n=i.ancestor(o.commonAncestor(),i.isCell),r=e(n).closest("tr"),l=r.children("td, th").index(e(n)),c=e(r).closest("table").find("colgroup").children("col"),s=r.children().index(e(n)),d=new t(n,t.where.Column,t.requestAction.Delete,e(r).closest("table")[0]).getActionList(),b=0;b<d.length;b++)if(d[b])switch(d[b].action){case t.resultAction.Ignore:continue;case t.resultAction.SubtractSpanCount:var f=d[b].baseCell;if(f.colSpan&&f.colSpan>1){var p=f.colSpan?parseInt(f.colSpan,10):0;p>2?(p--,f.setAttribute("colSpan",p),f.cellIndex===l&&(f.innerHTML="")):2===p&&(f.removeAttribute("colSpan"),f.cellIndex===l&&(f.innerHTML=""))}continue;case t.resultAction.RemoveCell:i.remove(d[b].baseCell,!0);continue}if(c.length){var g=c[s];e(g).remove()}a.afterCommand()}},a.recoverAttributes=function(e){var t="";if(!e)return t;for(var o=e.attributes||[],n=0;n<o.length;n++)"id"!==o[n].name.toLowerCase()&&("span"===o[n].name.toLowerCase()&&"col"==e.tagName.toLowerCase()||o[n].specified&&(t+=" "+o[n].name+"='"+o[n].value+"'"));return t},a.beforeCommand=function(){u.editor.beforeCommand.call(u.editor)},a.afterCommand=function(){u.editor.afterCommand.call(u.editor)},o.memo("button.jTable",(function(){return c.buttonGroup([c.button({className:"dropdown-toggle",contents:c.dropdownButtonContents(c.icon(b.icons.table),b),tooltip:f.table.table,container:b.container,data:{toggle:"dropdown"},click:function(e){a.recoverPopover(e)}}),c.dropdown({title:f.table.table,className:"note-table",items:['<div class="note-dimension-picker">','<div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div>','<div class="note-dimension-picker-highlighted"></div>','<div class="note-dimension-picker-unhighlighted"></div>',"</div>",'<div class="note-dimension-display">1 x 1</div>'].join("")})],{callback:function(e){e.find(".note-dimension-picker-mousecatcher").css({width:b.insertTableMaxSize.col+"em",height:b.insertTableMaxSize.row+"em"}).mousedown(o.createInvokeHandler("jTable.insertTable")).on("mousemove",u.buttons.tableMoveHandler.bind(o))}}).render()})),a.insertTable=function(e){a.beforeCommand();var t=e.split("x"),o=u.editor.getLastRange().deleteContents(),n=a.createTable(t[0],t[1],b);o.insertNode(n),a.afterCommand()},a.createTable=function(t,o,n){for(var r,a,l=[],c=[],s=0;s<t;s++)c.push("<td>"+i.blank+"</td>"),l.push('<col style="width: 100px;"/>');r="<colgroup>"+l.join("")+"</colgroup>",a=c.join("");for(var d,u=[],b=0;b<o;b++)u.push("<tr>"+a+"</tr>");d=u.join("");var f=e('<table class="jtable-expanded" style="width: auto !important;">'+r+d+"</table>");return n&&n.tableClassName&&f.addClass(n.tableClassName),f[0]},o.memo("button.jBorderColor",(function(){return a.colorPalette("note-color-table-border",f.jTable.borderColor,a.jBorderColor)})),a.jBorderColor=function(t){a.beforeCommand();var o=h.currentTdEl;if(!o)return a.afterCommand();e(o).closest("table").find("td, th").css("border","1px solid "+t),a.afterCommand()},o.memo("button.jBackcolor",(function(){return a.colorPalette("note-color-back",f.color.background,a.color)})),a.color=function(o){a.beforeCommand();var n=h.currentTdEl;if(!n)return a.afterCommand();for(var r=e(n).closest("table"),l=new t(n,void 0,void 0,r[0]).getMatrixTable(),i=h.effect.row,c=h.effect.col,s=i.start;s<=i.end;s++)for(var d=c.start;d<=c.end;d++){var u=l[s][d];e(u.baseCell).css("background-color",o)}a.afterCommand()},a.colorPalette=function(t,o,n){return c.buttonGroup({className:"note-color jtable-display "+t,children:[c.button({className:"note-current-color-button note-table-color",contents:c.icon(b.icons.font+" note-recent-color"),tooltip:o,container:b.container,click:function(t){var o=e(t.currentTarget).attr("data-backColor");n(o)},callback:function(e){var o=e.find(".note-recent-color");o.css("background-color","note-color-table-border"==t?"#000000":b.colorButton.backColor),e.attr("data-backColor","note-color-table-border"==t?"#000000":b.colorButton.backColor),o.css("color","transparent")}}),c.button({className:"dropdown-toggle",contents:c.dropdownButtonContents("",b),tooltip:f.color.more,container:b.container,data:{toggle:"dropdown"},click:function(e){a.recoverPopover(e)}}),c.dropdown({items:['<div class="note-palette">','<div class="note-palette-title">'+o+"</div>","<div>",'<button type="button" class="note-color-reset btn btn-light" data-event="backColor" data-value="inherit">',f.color.transparent,"</button>","</div>",'<div class="note-holder" data-event="backColor"/>',"<div>"].join(""),callback:function(t){t.find(".note-holder").each((function(t,o){var n=e(o);n.append(c.palette(d({colors:b.colors,colorsName:b.colorsName,eventName:n.data("event"),container:b.container,tooltip:b.tooltip},"container",b.container)).render())}));var o=[["#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"]];t.find(".note-holder-custom").each((function(t,n){var r=e(n);r.append(c.palette(d({colors:o,colorsName:o,eventName:r.data("event"),container:b.container,tooltip:b.tooltip},"container",b.container)).render())})),t.find("input[type=color]").each((function(o,n){e(n).change((function(){var o=t.find("#"+e(this).data("event")).find(".note-color-btn").first(),n=this.value.toUpperCase();o.css("background-color",n).attr("aria-label",n).attr("data-value",n).attr("data-original-title",n),o.click()}))}))},click:function(t){var o=e(this).closest(".note-popover").find(".note-dropdown-menu"),r=e(t.target),a=r.data("event"),l=r.attr("data-value");if("openPalette"===a){var i=o.find("#"+l),c=e(o.find("#"+i.data("event")).find(".note-color-row")[0]),s=c.find(".note-color-btn").last().detach(),d=i.val();s.css("background-color",d).attr("aria-label",d).attr("data-value",d).attr("data-original-title",d),c.prepend(s),i.click()}else{var u="backColor"===a?"background-color":"color",b=r.closest(".note-color").find(".note-recent-color"),f=r.closest(".note-color").find(".note-current-color-button");b.css(u,l),f.attr("data-"+a,l),n(l)}}})]}).render()},a.setCellHorizontalAlign=function(o){a.beforeCommand();for(var n=h.currentTdEl,r=e(n).closest("table"),l=new t(n,void 0,void 0,r[0]).getMatrixTable(),i=h.effect.row,c=h.effect.col,s=i.start;s<=i.end;s++)for(var d=c.start;d<=c.end;d++){var u=l[s][d];e(u.baseCell).css("text-align",o)}a.afterCommand()},a.setCellVerticalAlign=function(o){a.beforeCommand();for(var n=h.currentTdEl,r=e(n).closest("table"),l=new t(n,void 0,void 0,r[0]).getMatrixTable(),i=h.effect.row,c=h.effect.col,s=i.start;s<=i.end;s++)for(var d=c.start;d<=c.end;d++){var u=l[s][d];e(u.baseCell).css("vertical-align",o)}a.afterCommand()};var j=[c.button({contents:c.icon(b.icons.alignLeft),tooltip:f.paragraph.left,container:b.container,click:o.createInvokeHandler("jTable.setCellHorizontalAlign","left")}),c.button({contents:c.icon(b.icons.alignCenter),tooltip:f.paragraph.center,container:b.container,click:o.createInvokeHandler("jTable.setCellHorizontalAlign","center")}),c.button({contents:c.icon(b.icons.alignRight),tooltip:f.paragraph.right,container:b.container,click:o.createInvokeHandler("jTable.setCellHorizontalAlign","right")}),c.button({contents:c.icon(b.icons.alignJustify),tooltip:f.paragraph.justify,container:b.container,click:o.createInvokeHandler("jTable.setCellHorizontalAlign","justify")})],T=[c.button({className:"jtable-vertical-align-btn-top",contents:c.icon(b.icons.alignJustify),tooltip:f.jTable.align.top,container:b.container,click:o.createInvokeHandler("jTable.setCellVerticalAlign","top")}),c.button({className:"jtable-vertical-align-btn-middle",contents:c.icon(b.icons.alignJustify),tooltip:f.jTable.align.middle,container:b.container,click:o.createInvokeHandler("jTable.setCellVerticalAlign","middle")}),c.button({className:"jtable-vertical-align-btn-bottom",contents:c.icon(b.icons.alignJustify),tooltip:f.jTable.align.bottom,container:b.container,click:o.createInvokeHandler("jTable.setCellVerticalAlign","bottom")}),c.button({className:"jtable-vertical-align-btn-baseline",contents:c.icon(b.icons.alignJustify),tooltip:f.jTable.align.baseline,container:b.container,click:o.createInvokeHandler("jTable.setCellVerticalAlign","baseline")})];o.memo("button.jAlign",(function(){return c.buttonGroup([c.button({className:"dropdown-toggle jtable-display",contents:c.dropdownButtonContents(c.icon(b.icons.alignLeft),b),tooltip:f.paragraph.paragraph,container:b.container,data:{toggle:"dropdown"},click:function(e){a.recoverPopover(e)}}),c.dropdown({className:"jtable-align-dropdown",children:[c.buttonGroup({className:"jtable-horizontal-align-button-group",children:j}),c.buttonGroup({className:"jtable-vertical-align-button-group",children:T})]})],{callback:function(e){}}).render()}));var x=['<div class="form-group">','<label for="jtable-cell-merge-col'+b.id+'" class="note-form-label jtable-merge-label">'+f.jTable.merge.colspan+"</label>",'<input id="jtable-cell-merge-col'+b.id+'" class="note-input jtable-merge-input jtable-merge-col-input" type="number" name="col"/>','<span class="jtable-merge-hint-span">(min : <span class="jtable-merge-hint-col-min">1</span> / max : <span class="jtable-merge-hint-col-max">1</span>)</span>',"</div>",'<div class="form-group jtable-merge-row-info-div">','<label for="jtable-cell-merge-row'+b.id+'" class="note-form-label jtable-merge-label">'+f.jTable.merge.rowspan+"</label>",'<input id="jtable-cell-merge-row'+b.id+'" class="note-input jtable-merge-input jtable-merge-row-input" type="number" name="row"/>','<span class="jtable-merge-hint-span">(min : <span class="jtable-merge-hint-row-min">1</span> / max : <span class="jtable-merge-hint-row-max">1</span>)</span>',"</div>"].join(""),y='<input type="button" href="#" class="btn btn-primary note-btn note-btn-primary jtable-merge-btn" value="'+f.jTable.merge.merge+'" disabled>';(n=c.dialog({title:f.jTable.merge.merge,fade:b.dialogsFade,body:x,footer:y}).render().appendTo(b.container)).find(".note-modal-content").width(340),n.find(".note-modal-body").css("padding","20px 20px 10px 20px");var A=[c.button({contents:c.icon("note-icon-table-merge"),tooltip:f.jTable.merge.merge,container:b.container,click:o.createInvokeHandler("jTable.cellMerge")}),c.button({className:"note-btn-jtable-cell-split",contents:c.icon("note-icon-table-cell-split"),tooltip:f.jTable.merge.split,container:b.container,click:o.createInvokeHandler("jTable.cellSplit")})];function S(t,o){a.beforeCommand();var n=e(t),r=o.merge.col-o.current.col,l=o.merge.row-o.current.row;n.prop("colspan",o.merge.col);for(var i=0;i<r;i++)e(o.effect.col[i]).remove();for(n.prop("rowspan",o.merge.row),i=0;i<l;i++){var c=o.effect.row[i];if(r>0)for(var s=0;s<r;s++)e(c).next().remove();e(c).remove()}var d=n.closest("table"),u=d.children("tr");for(u.length||(u=d.children("tbody").children("tr")),i=0;i<u.length;i++){var b=e(u[i]);b.find("td, th").length||b.remove()}a.afterCommand()}function k(o){for(var n=e(o),r=n.closest("table"),a=n.closest("tr"),l=parseInt(o.colSpan,10),i=parseInt(o.rowSpan,10),c=l-1,s=a[0].rowIndex,d=s+i-1,u=new t(o,void 0,void 0,r[0]),b=u.getMatrixTable(),f=(u.getColCount(),!1),p=[],g=s;g<=d;g++){for(var v=b[g],m=0;m<v.length;m++){if(f&&o!=v[m].baseCell&&!v[m].isVirtual){if(p.push(v[m].baseCell),g==s)for(var h=0;h<c;h++)e(v[m].baseCell).before(e("<td/>"));else for(h=0;h<l;h++)e(v[m].baseCell).before(e("<td/>"));break}if(o==v[m].baseCell&&(f=!0),f&&m==v.length-1){var w=v[m].baseCell;if(g==s)for(h=0;h<c;h++)e(w).after(e("<td/>"));else{var C=r.children("tr");for(C.length||(C=C.children("tbody").children("tr")),w=e(C[g]).children().last(),h=0;h<l;h++)e(w).after(e("<td/>"))}}}f=!1}n.prop("colspan",1),n.prop("rowspan",1)}function I(o){var n=e(o).closest("table"),r=e(o).closest("tr")[0].rowIndex,a=new t(o,void 0,void 0,n[0]).getMatrixTable(),l=a[r],i=0,c=!1,s=1,d=[];if(o.rowSpan>1)s=o.colSpan;else for(var u=0;u<l.length;u++){var b=l[u];c&&(d.push(b.baseCell),s++),c||o!=b.baseCell?c&&(b.baseCell.colSpan>1||b.baseCell.rowSpan>1)&&(s--,d.pop(),c=!1):(i=u,c=!0)}c=!1;var f=1,p=[];if(o.colSpan>1)f=o.rowSpan;else for(var g=0;g<a.length;g++)b=a[g][i],c&&(p.push(b.baseCell),f++),c||o!=b.baseCell?c&&(b.baseCell.colSpan>1||b.baseCell.rowSpan>1)&&(f--,p.pop(),c=!1):c=!0;return{trIndex:r,tdIndex:i,current:{col:o.colSpan,row:o.rowSpan},max:{col:s,row:f},effect:{col:d,row:p}}}o.memo("button.jMerge",(function(){return c.buttonGroup({className:"jtable-display",children:[c.button({className:"dropdown-toggle jtable-cell-split-dropdown-toggle",contents:c.dropdownButtonContents(c.icon("note-icon-table-merge"),b),tooltip:f.jTable.merge.merge,container:b.container,data:{toggle:"dropdown"},click:function(t){var o=e(this).parent().find(".note-btn-jtable-cell-split"),n=!1,r=u.editor.getLastRange.call(u.editor);if(r.isCollapsed()&&r.isOnCell()){var l=i.ancestor(r.commonAncestor(),i.isCell);n=l.rowSpan>1||l.colSpan>1}o.toggleClass("disabled",!n),o.attr("disabled",!n),a.recoverPopover(t)}}),c.dropdown({className:"jtable-cell-split-dropdown",children:[c.buttonGroup({className:"jtable-cell-split-button-group",children:A})]})]}).render()})),a.cellMerge=function(){"drag"==b.jTable.mergeMode?a.dragCellMerge():a.mergeDialogShow()},a.dragCellMerge=function(){var o=h.currentTdEl,n=e(o),r=n.closest("table"),a=new t(o,void 0,void 0,r[0]).getMatrixTable(),l=h.effect.row,i=h.effect.col;if(l.start==l.end&&i.start==i.end)return H(n),!0;for(var c=l.start;c<=l.end;c++)for(var s=i.start;s<=i.end;s++)k(a[c][s].baseCell);var d=I(o),u={trIndex:d.trIndex,colIndex:d.colIndex,current:{col:d.current.col,row:d.current.row},merge:{col:parseInt(i.end-i.start+1,10),row:parseInt(l.end-l.start+1,10)},effect:{col:d.effect.col,row:d.effect.row}};S(a[l.start][i.start].baseCell,u),H(n)},a.mergeDialogShow=function(){var t=u.editor.getLastRange.call(u.editor);if(t.isCollapsed()&&t.isOnCell()){var r=I(i.ancestor(t.commonAncestor(),i.isCell));u.tablePopover.hide(),o.invoke("editor.saveRange"),function(t){return e.Deferred((function(e){var r=n.find(".jtable-merge-input"),a=n.find(".jtable-merge-col-input"),l=n.find(".jtable-merge-hint-col-min"),i=n.find(".jtable-merge-hint-col-max"),s=n.find(".jtable-merge-row-input"),d=n.find(".jtable-merge-hint-row-min"),u=n.find(".jtable-merge-hint-row-max"),b=n.find(".jtable-merge-btn");a.val(t.current.col),l.text(t.current.col),i.text(t.max.col),s.val(t.current.row),d.text(t.current.row),u.text(t.max.row),c.onDialogShown(n,(function(){o.triggerEvent("dialog.shown"),r.on("input paste propertychange",(function(){var e=!1,o=parseInt(a.val(),10),n=parseInt(s.val(),10);o==t.current.col&&n==t.current.row?e=!1:o>=t.current.col&&o<=t.max.col&&n>=t.current.row&&n<=t.max.row&&(e=!0),c.toggleBtn(b,e)})),b.click((function(o){o.preventDefault(),e.resolve({trIndex:t.trIndex,colIndex:t.colIndex,current:{col:t.current.col,row:t.current.row},merge:{col:parseInt(a.val(),10),row:parseInt(s.val(),10)},effect:{col:t.effect.col,row:t.effect.row}})}))})),c.onDialogHidden(n,(function(){r.off(),b.off(),c.toggleBtn(b,!1),"pending"===e.state()&&e.reject()})),c.showDialog(n)}))}(r).then((function(e){c.hideDialog(n),o.invoke("editor.restoreRange"),S(i.ancestor(t.commonAncestor(),i.isCell),e)})).fail((function(){o.invoke("editor.restoreRange")}))}},a.cellSplit=function(){var e=u.editor.getLastRange.call(u.editor);e.isCollapsed()&&e.isOnCell()&&(a.beforeCommand(),k(i.ancestor(e.commonAncestor(),i.isCell)),a.afterCommand())};var R=['<div class="form-group form-group-jtable-table-info-margin">','<div class="jtable-table-info-margin-top-bottom"><input type="number" value="0" class="jtable-table-info-margin-input jtable-table-info-margin-input-top"><span>px</span></div>','<div class="jtable-table-info-margin-middle">','<div class="jtable-table-info-margin-left"><input type="number" value="0" class="jtable-table-info-margin-input jtable-table-info-margin-input-left"><span>px</span></div>','<div class="jtable-table-info-margin-center"><b>Table</b><br><span class="jtable-table-info-width">0</span> X <span class="jtable-table-info-height">0</span></div>','<div class="jtable-table-info-margin-right"><input type="number" value="0" class="jtable-table-info-margin-input jtable-table-info-margin-input-right"><span>px</span></div>',"</div>",'<div class="jtable-table-info-margin-top-bottom"><input type="number" value="0" class="jtable-table-info-margin-input jtable-table-info-margin-input-bottom"><span>px</span></div>',"</div>"].join(""),F='<input type="button" href="#" class="btn btn-primary note-btn note-btn-primary jtable-apply-btn" value="'+f.jTable.apply+'" >';function E(e,t,o){switch(e){case"width":t.width(o);break;case"height":t.children().height(o)}}function N(e,t){e.closest(".note-editing-area").css("cursor","auto"),e.closest(".note-editable").prop("contenteditable",t)}function P(){m={pressed:!1,rightFlag:!1,bottomFlag:!1,currentTableEl:void 0,firstTdEl:void 0,colEl:void 0,currentTdEl:void 0,currentTdLeft:void 0,currentTdRight:void 0,currentTdTop:void 0,currentTdBottom:void 0,startX:void 0,startWidth:void 0,startY:void 0,startHeight:void 0,contenteditable:!1}}function H(e){h={pressed:!1,currentTableEl:void 0,currentTdEl:void 0,currentTdLeft:void 0,currentTdRight:void 0,currentTdTop:void 0,currentTdBottom:void 0,currentTdPosition:{row:void 0,col:void 0},width:void 0,height:void 0,top:void 0,left:void 0,effect:{row:{start:void 0,end:void 0},col:{start:void 0,end:void 0}}},e.closest(".note-editing-area").find(".jtable-block").hide()}function L(e,o){for(var n=new t(e,void 0,void 0,o).getMatrixTable(),r=0;r<n.length;r++)for(var a=n[r],l=0;l<a.length;l++)if(n[r][l].baseCell==e)return{row:r,col:l}}(r=c.dialog({title:f.table.table+" "+f.jTable.info.margin,fade:b.dialogsFade,body:R,footer:F}).render().appendTo(b.container)).find(".note-modal-body").css("padding","20px 20px 10px 20px"),o.memo("button.jTableInfo",(function(){return c.button({className:"jtable-display",contents:c.icon("note-icon-table-margin"),tooltip:f.table.table+" "+f.jTable.info.margin,container:b.container,click:o.createInvokeHandler("jTable.tableInfoDialogShow")}).render()})),a.tableInfoDialogShow=function(){var t=u.editor.getLastRange.call(u.editor);if(t.isCollapsed()&&t.isOnCell()){var a=i.ancestor(t.commonAncestor(),i.isCell),l=e(a).closest("table");u.tablePopover.hide(),function(t){return e.Deferred((function(e){var a=r.find(".jtable-apply-btn"),l=r.find(".jtable-table-info-margin-input"),i=r.find(".jtable-table-info-margin-input-top"),s=r.find(".jtable-table-info-margin-input-left"),d=r.find(".jtable-table-info-margin-input-right"),u=r.find(".jtable-table-info-margin-input-bottom"),b=r.find(".jtable-table-info-width"),f=r.find(".jtable-table-info-height");i.val(parseInt(t.css("margin-top"),10)),s.val(parseInt(t.css("margin-left"),10)),d.val(parseInt(t.css("margin-right"),10)),u.val(parseInt(t.css("margin-bottom"),10)),b.text(t.width()),f.text(t.height()),c.onDialogShown(r,(function(){o.triggerEvent("dialog.shown"),l.on("input paste propertychange",(function(){var e=!0,t=parseInt(i.val(),10),o=parseInt(s.val(),10),n=parseInt(d.val(),10),r=parseInt(u.val(),10);(t<0||o<0||n<0||r<0)&&(e=!1),c.toggleBtn(a,e)})),a.click((function(t){o.invoke("beforeCommand"),t.preventDefault(),e.resolve([parseInt(i.val(),10)+"px",parseInt(d.val(),10)+"px",parseInt(u.val(),10)+"px",parseInt(s.val(),10)+"px"]),o.invoke("afterCommand")}))})),c.onDialogHidden(n,(function(){l.off(),a.off(),c.toggleBtn(a,!1),"pending"===e.state()&&e.reject()})),c.showDialog(r)}))}(l).then((function(e){c.hideDialog(r),o.invoke("editor.restoreRange"),l.css("margin",e.join(" "))})).fail((function(){o.invoke("editor.restoreRange")}))}},o.memo("button.jWidthHeightReset",(function(){return c.button({className:"jtable-display",contents:c.icon("note-icon-table-width-height-reset"),tooltip:f.table.table+" "+f.jTable.areaReset,container:b.container,click:o.createInvokeHandler("jTable.jWidthHeightReset")}).render()})),a.jWidthHeightReset=function(){var o=u.editor.getLastRange.call(u.editor);if(o.isCollapsed()&&o.isOnCell()){a.beforeCommand();var n=i.ancestor(o.commonAncestor(),i.isCell),r=e(n).closest("table");r.removeAttr("width"),r.removeAttr("height"),r.css("width","auto"),r.css("height","");var l=r.find("tr, td, th");l.removeAttr("width"),l.removeAttr("height"),l.css("width",""),l.css("height","");var c=new t(n,void 0,void 0,r[0]).getColCount();r.find("colgroup:first").remove();for(var s=e("<colgroup/>"),d=0;d<c;d++)s.append('<col style="width: 100px;"/>');r.prepend(s),a.afterCommand()}},a.expandColgroup=function(e){for(var t="",o=e.closest("table"),n=0;n<e.length;n++){var r=e[n],a=r.span;r.removeAttribute("width");for(var l=r.offsetWidth,i=r.offsetHeight,c='style="width:'.concat(l,"px; height:").concat(i,'px"');a>0;)t=t.concat("<col ".concat(c," />")),a-=1}e.closest("colgroup").html(t),o.removeAttr("width"),o.css("width",""),o.css("table-layout","fixed")},a.events={"summernote.init":function(n,r){r.editingArea.append('<div class="jtable-block"><div/>'),r.toolbar.find(".jtable-display").hide(),r.editingArea.on("keydown",(function(o){if((o.metaKey||o.ctrlKey)&&"c"===String.fromCharCode(o.which).toLowerCase()){var n=e(o.target);if("block"==n.closest(".note-editing-area").find(".jtable-block").css("display")){var r=h.currentTableEl,a=h.effect,l=new t(this,void 0,void 0,r).getVirtualTable(),i=document.createElement("table");i.className=r.className,e(i).toggleClass("jtable-expanded",!1);for(var c=document.createElement("colgroup"),s=e(r).find("colgroup col"),d=0;d<l[0].length;d++){var u=l[0][d],b=document.createElement("col"),f=s[d].style.width?s[d].style.width:u.baseCell.style.width;b.style.width=f,c.appendChild(b)}i.appendChild(c);for(var p=a.row.start;p<=a.row.end;p++){for(var g=l[p],v=document.createElement("tr"),m=a.col.start,w=0;m<=a.col.end;m++,w++){var C=g[m];C.isVirtual||(v.style.width=c.childNodes[w].style.width,e(v).append(C.baseCell.outerHTML))}i.appendChild(v)}n.closest(".note-editor").after(i),e.summernote.range.createFromNode(i).select(),document.execCommand("copy"),e(i).remove()}}})),r.editingArea.on("paste",".note-editable",(function(o){var n=e(o.target).closest(".note-editable");setTimeout((function(){for(var o=n.find("table").not(".jtable-expanded"),r=0;r<o.length;r++){var l=e(o[r]);if(l.children("colgroup").children("col").length)c=l.children("colgroup").children("col"),a.expandColgroup(c),l.toggleClass("jtable-expanded",!0);else{for(var i=new t(this,void 0,void 0,o[r]).getVirtualTable(),c=document.createElement("colgroup"),s=0;s<i[0].length;s++){var d=i[0][s],u=document.createElement("col"),b=d.baseCell.style.width;if(d.baseCell.colSpan>1){var f=b.match(/([0-9]*)([a-z]*$)/);b=f[1]/d.baseCell.colSpan+f[2]}u.style.width=b,c.appendChild(u)}l.prepend(c)}}}),1)})),r.editingArea.on("paste",".note-editable",(function(o){setTimeout((function(){var n=e(o.target).closest(".note-editable"),r=n.closest(".note-editing-area").find(".jtable-block");if(!h.currentTableEl||!r[0]||"none"==r[0].style.display)return!0;var l=n.find("table.jtable-paste");if(l.length||(l=e(o.target).find("table")),!l.length)return!0;l.remove();var i=l.find("tr, td, th"),c=new t(i,void 0,void 0,l[0]).getMatrixTable(),s=c.length,d=c[0].length,u=h.currentTableEl,b=h.currentTdEl,f=h.effect.row,p=h.effect.col,g=f.end-f.start+1,v=p.end-p.start+1,m=0;if((m=s==g&&d==v?1:d>v||s>g?2:0)>0){if(2==m){for(var w=v;w<d;w++)a.addCol(b,"right");v=d;for(var C=g;C<s;C++)a.addRow(b,"bottom");g=s}for(var j=new t(b,void 0,void 0,u).getMatrixTable(),T=0;T<g;T++)for(var x=j[T+f.start],y=c[T].filter((function(e){return!e.isVirtual})),A=0;A<v;A++)(L=x[A+p.start])&&y[A]&&(L.baseCell.innerText=y[A].baseCell.innerText)}else{for(var S=[],k=0,I=0;I<c.length;I++)for(var R=c[I],F=0;F<R.length;F++){var E=R[F];S.push(E)}for(var N=0;N<g;N++)for(var P=u.rows[N+f.start],H=0;H<v;H++,k++){var L=P.cells[H+p.start];if(!S[k])break;L.innerText=S[k].baseCell.innerText}}r.hide()}),1)})),r.editingArea.on("click",(function(t){var o=e(t.target).closest(".note-editor").find(".note-toolbar .jtable-display");"none"==e(t.target).closest(".note-editable").next(".jtable-block").css("display")&&o.hide()})),r.editingArea.on("click",".note-editable table",(function(t){var o=e(t.target).closest("td");o.length||(o=e(t.target).closest("th")),o.length&&u.tablePopover.update(o[0]),e(t.target).closest(".note-editor").find(".note-toolbar .jtable-display").show(),t.stopPropagation()})),r.editingArea.on("mouseleave",".note-editable tr",(function(t){if(h.pressed)return!0;if(m.pressed)return!0;var o=e(this),n=o.closest(".note-editing-area").css("cursor");"row-resize"!=n&&"col-resize"!=n||o.closest(".note-editing-area").css("cursor","auto")})),r.editingArea.on("mousemove",".note-editable td,th",(function(t){if(h.pressed)return!0;if(m.pressed)return!0;var o=e(this),n=(o.closest("table"),o.closest("tr")),r=o.offset().left+o.outerWidth(),a=n.offset().top+o.outerHeight(),l=!1;r-5<=t.pageX&&(l=!0);var i,c=!1;a-5<=t.pageY&&(c=!0),i=l?"col-resize":c?"row-resize":"auto",o.closest(".note-editing-area").css("cursor",i)})),r.editingArea.on("mousedown","td",(function(t){if(h.pressed)return!0;var o=e(this);if(H(o),m.pressed)return!0;var n=o.closest("table"),r=o.offset().top,a=o.offset().left,l=a+o.outerWidth(),i=r+o.outerHeight(),c=L(this,n[0]);h={pressed:!0,currentTableEl:n[0],currentTdEl:this,currentTdLeft:a,currentTdRight:l,currentTdTop:r,currentTdBottom:i,currentTdPosition:{row:c.row,col:c.col},width:l,height:i,top:r,left:a,effect:{row:{start:c.row,end:c.row},col:{start:c.col,end:c.col}}},t.stopPropagation()})),r.editingArea.on("mouseup","td",(function(t){var o=e(this);if(!h.pressed)return!0;var n=o.closest("table"),r=L(this,n[0]),a=h.currentTdPosition.row<r.row||h.currentTdPosition.col<r.col,l=a?h.currentTdTop:o.offset().top,i=a?h.currentTdLeft:o.offset().left,c=o.outerWidth(),d=o.outerHeight(),u=a?h.currentTdRight:i+c,b=a?h.currentTdBottom:l+d;h=s(s({},h),{},{pressed:!1,currentTableEl:a?h.currentTableEl:n[0],currentTdEl:a?h.currentTdEl:this,currentTdLeft:i,currentTdRight:u,currentTdTop:l,currentTdBottom:b,currentTdPosition:{row:r.row,col:r.col},width:u,height:b,top:l,left:i})})),r.editingArea.on("mousemove",".note-editable",(function(t){if(!h.pressed)return!0;u.tablePopover.hide();var o=e(t.target).closest("td");o.length||(o=e(t.target).closest("th"));var n=o.closest(".note-editing-area").find(".jtable-block");if(o.length){var r=o.closest("table"),a=o.offset().top,l=o.offset().left,i=l+o.outerWidth(),c=a+o.outerHeight(),s=L(o[0],r[0]),d=h.effect.col,b=h.effect.row;h.currentTdLeft>=l?(h.left=l,h.width=h.currentTdRight-l,d.end=h.currentTdPosition.col,d.start=s.col):(h.width=i-h.left,d.end=s.col),h.currentTdTop>=a?(h.top=a,h.height=h.currentTdBottom-a,b.end=h.currentTdPosition.row,b.start=s.row):(h.height=c-h.top,b.end=s.row),n.show(),n.offset({left:h.left,top:h.top}),n.css({width:h.width,height:h.height})}})),r.editingArea.on("mousedown",".note-editable",(function(t){e(t.target).closest(".note-editable").next(".jtable-block").hide()})),r.editingArea.on("mousemove mousedown touchstart",".note-editable",(function(e){if(!h.pressed)return!0})),r.editingArea.on("mouseup",".note-editable",(function(t){if(g){var o=e("table.unselectable");o.toggleClass("unselectable",!1),o.attr("unselectable","off")}if(!h.pressed)return!0;h.pressed=!1;var n=e(t.target).closest("td");n.length||(n=e(t.target).closest("th")),n.length&&u.tablePopover.update(n[0])}));var i=null;function c(){var o=e(this).closest(".note-editor").find("table"),n=new t(void 0,void 0,void 0,o[0]).getVirtualTable().map((function(e,t){return e.map((function(e){return i[t].reduce((function(t,o){return o.baseCell===e.baseCell||t}),!1)}))})),r=l(n),a=o.children("tbody"),c=(r.reduce((function(e,t,o){var r=-1,i=-1,c=!1;if(t.forEach((function(e,t){-1===r&&!1===e&&(r=t),r>-1&&!1===e&&r+1===t&&(c=!0,i=t),i>-1&&!1===e&&i+1===t&&(i=t)})),c){if(n=n.reduce((function(e,t,a){if(a===o){var c=n[o].filter((function(e,t){return!(t>=r&&t<=i)}));return[].concat(l(e),[c])}return[].concat(l(e),[t])}),[]),!a[0])return;a[0].childNodes[o].childNodes[r].remove(),a[0].childNodes[o].childNodes[r].colSpan=a[0].childNodes[o].childNodes[r].colSpan+1}return[].concat(l(e),[{tdIdxStart:r,tdIdxEnd:i,hasError:c}])}),[]),n.reduce((function(e,t,o){return t.length>=e.length&&t.reduce((function(e,t){return!t||e}),!1)?{trIdx:o,length:t.length}:e}),{trIdx:-1,length:0})),s=o.children("colgroup").children("col"),d=0;if(n[c.trIdx]){var u=n[c.trIdx].reduce((function(e,t){if(!t)return e+'<col style="width: 100px;" />';var o=e+s[d].outerHTML;return d++,o}),"");s.closest("colgroup").html(u),H(o)}}function d(){var o=e(this).closest(".note-editor").find("table"),n=new t(void 0,void 0,void 0,o[0]).getVirtualTable(),r=i.map((function(e,t){return e.map((function(e){return n[t].reduce((function(t,o){return o.baseCell===e.baseCell||t}),!1)}))})),a=r.reduce((function(e,t,o){return t.length>=e.length&&t.reduce((function(e,t){return!t||e}),!1)?{trIdx:o,length:t.length}:e}),{trIdx:-1,length:0}),l=o.children("colgroup").children("col");if(r[a.trIdx]){var c=r[a.trIdx].reduce((function(e,t,o){return t?e+l[o].outerHTML:e}),"");l.closest("colgroup").html(c),H(o)}}r.editor.on("click",'[aria-label="Add column left"]',c),r.editor.on("click",'[aria-label="左方插入欄"]',c),r.editor.on("click",'[aria-label="Add column right"]',c),r.editor.on("click",'[aria-label="右方插入欄"]',c),r.editor.on("click",'[aria-label="Delete column"]',d),r.editor.on("click",'[aria-label="刪除欄"]',d),r.editingArea.on("mousedown","td",(function(o){var n=e(this),r=n.closest("table"),l=new t(this,void 0,void 0,r[0]).getVirtualTable();i=l;var c=n.closest("tr"),s=n.offset().left,d=s+n.outerWidth(),b=c.offset().top,f=b+n.outerHeight(),p=!1;d-5<=o.pageX&&(p=!0);var v=!1;f-5<=o.pageY&&(v=!0);var h,w=n.closest(".note-editable").prop("contenteditable");if(!p&&!v)return N(n,w),void P();u.tablePopover.hide(),h=p?"col-resize":"row-resize",n.closest(".note-editing-area").css("cursor",h),n.closest(".note-editable").removeAttr("contenteditable");var C=r.children("colgroup").children("col");a.expandColgroup(C);for(var j=r.find("td"),T=0;T<j.length;T++){var x=j[T];x.width&&(x.width=""),x.style.width&&(x.style.width="")}for(var y=c[0].rowIndex,A=this.colSpan>1,S=l[y],k=0;k<S.length&&this!=S[k].baseCell;k++);A&&(k+=this.colSpan-1);var I=l[0][k].baseCell,R=r.find("colgroup:first col")[k],F=n.width();R&&(F=e(R).width()),m={pressed:!0,rightFlag:p,bottomFlag:v,currentTableEl:r[0],currentTrEl:c[0],firstTdEl:I,colEl:R,currentTdEl:this,currentTdLeft:s,currentTdRight:d,currentTdTop:b,currentTdBottom:f,startX:o.pageX,startWidth:F,startY:o.pageY,startHeight:n.height(),contenteditable:w},g&&(r.toggleClass("unselectable",!0),r.attr("unselectable","on")),H(n),o.stopPropagation()})),r.editingArea.on("mousemove",".note-editable",(function(t){if(!m.pressed)return!0;var o=e(this),n=m.currentTdLeft,r=m.currentTdTop;if(m.rightFlag){if(!(n+1<=t.pageX))return N(o,m.contenteditable),P(),!0;var a=m.firstTdEl;m.colEl&&(a=m.colEl);var l=m.startWidth+(t.pageX-m.startX);E("width",e(a),l)}else if(m.bottomFlag){if(!(r+1<=t.pageY))return N(o,m.contenteditable),P(),!0;a=m.currentTrEl;var i=m.startHeight+(t.pageY-m.startY);E("height",e(a),i)}})),r.editingArea.on("mousemove mousedown touchstart",".note-editable",(function(e){if(!m.pressed)return!0;e.preventDefault()})),r.editingArea.on("mouseup",".note-editable",(function(t){var n=e("table.unselectable");if(n.toggleClass("unselectable",!1),n.attr("unselectable","off"),!m.pressed)return!0;o.invoke("beforeCommand"),N(e(this),m.contenteditable),P(),o.invoke("afterCommand")}))}},a.initialize=function(){},a.destroy=function(){c.hideDialog(n),n.remove(),c.hideDialog(r),r.remove()}}}})})?n.apply(t,r):n)||(e.exports=a)}});