!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/",o(o.s=22)}({0:function(e,t){e.exports=$},22:function(e,t,o){var n,r,l;function a(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function s(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function c(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?s(Object(o),!0).forEach((function(t){d(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):s(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function d(e,t,o){return(t=function(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!==u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===u(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r=[o(0)],void 0===(l="function"==typeof(n=function(e){var t=function e(t,o,n,r){var l={colPos:0,rowPos:0},a=[],i=[],s=[];function c(e,t,o,n,r,l,i){var s={baseRow:o,baseCell:n,isRowSpan:r,isColSpan:l,isVirtual:i};a[e]||(a[e]=[]),a[e][t]=s}function d(e,t,o,n){return{baseCell:e.baseCell,action:t,virtualTable:{rowIndex:o,cellIndex:n}}}function u(e,t,o){if(!e[t])return o;if(!e[t][o])return o;for(var n=o;e[t][n];)if(n++,!e[t][n])return n}function f(e,t){var o=u(a,e.rowIndex,t.cellIndex),n=t.colSpan>1,r=t.rowSpan>1,i=e.rowIndex===l.rowPos&&t.cellIndex===l.colPos;c(e.rowIndex,o,e,t,r,n,!1);var s=t.attributes.rowSpan?parseInt(t.attributes.rowSpan.value,10):0;if(s>1)for(var d=1;d<s;d++){var f=e.rowIndex+d;p(f,o,t,i),c(f,o,e,t,!0,n,!0)}var b=t.attributes.colSpan?parseInt(t.attributes.colSpan.value,10):0;if(b>1)for(var g=1;g<b;g++){var v=u(a,e.rowIndex,o+g);p(e.rowIndex,v,t,i),c(e.rowIndex,v,e,t,r,!0,!0)}}function p(e,t,o,n){e===l.rowPos&&l.colPos>=o.cellIndex&&o.cellIndex<=t&&!n&&l.colPos++}function b(t){switch(o){case e.where.Column:if(t.isColSpan)return e.resultAction.SubtractSpanCount;break;case e.where.Row:if(!t.isVirtual&&t.isRowSpan)return e.resultAction.AddCell;if(t.isRowSpan)return e.resultAction.SubtractSpanCount}return e.resultAction.RemoveCell}function g(t){switch(o){case e.where.Column:if(t.isColSpan)return e.resultAction.SumSpanCount;if(t.isRowSpan&&t.isVirtual)return e.resultAction.Ignore;break;case e.where.Row:if(t.isRowSpan)return e.resultAction.SumSpanCount;if(t.isColSpan&&t.isVirtual)return e.resultAction.Ignore}return e.resultAction.AddCell}function v(e,t,o,n,r,l,a){var i={baseRow:o,baseCell:n,isRowSpan:r,isColSpan:l,isVirtual:a};s[e]||(s[e]=[]),s[e][t]=i}function m(e,t){var o=e.rowIndex,n=u(s,e.rowIndex,t.cellIndex),r=t.rowSpan>1,l=t.colSpan>1;v(o,n,e,t,r,l,!1);var a=t.rowSpan,i=t.colSpan;if(l)for(var c=1;c<i;c++)v(o,n+c,e,t,r,l,!0);if(r)for(var d=1;d<a;d++)if(v(o+d,n,e,t,r,l,!0),l)for(var f=1;f<i;f++)v(o+d,n+f,e,t,r,l,!0)}this.getActionList=function(){for(var t=o===e.where.Row?l.rowPos:-1,r=o===e.where.Column?l.colPos:-1,s=0,c=!0;c;){var u=t>=0?t:s,f=r>=0?r:s,p=a[u];if(!p)return c=!1,i;var v=p[f];if(!v)return c=!1,i;var m=e.resultAction.Ignore;switch(n){case e.requestAction.Add:m=g(v);break;case e.requestAction.Delete:m=b(v)}i.push(d(v,m,u,f)),s++}return i},this.getVirtualTable=function(){return a},this.getMatrixTable=function(){return s},this.getColCount=function(){for(var e=0,t=0;t<s.length;t++){var o=s[t];e<=o.length&&(e=o.length)}return e},t&&t.tagName&&("td"===t.tagName.toLowerCase()||"th"===t.tagName.toLowerCase())&&(l.colPos=t.cellIndex,t.parentElement&&t.parentElement.tagName&&"tr"===t.parentElement.tagName.toLowerCase()&&(l.rowPos=t.parentElement.rowIndex)),function(){for(var e=r.rows,t=0;t<e.length;t++)for(var o=e[t].cells,n=0;n<o.length;n++)f(e[t],o[n])}(),function(){for(var e=r.rows,t=0;t<e.length;t++)for(var o=e[t].cells,n=0;n<o.length;n++)m(e[t],o[n])}()};t.where={Row:0,Column:1},t.requestAction={Add:0,Delete:1},t.resultAction={Ignore:0,SubtractSpanCount:1,RemoveCell:2,AddCell:3,SumSpanCount:4},e.extend(!0,e.summernote.options,{jTable:{mergeMode:"drag"}}),e.extend(!0,e.summernote.lang,{"zh-TW":{jTable:{borderColor:"外框顏色",merge:{merge:"合併儲存格",colspan:"欄",rowspan:"列",split:"取消合併儲存格"},align:{top:"靠上對齊",middle:"置中對齊",bottom:"靠下對齊",baseline:"baseline"},info:{info:"table info",margin:"邊界"},autofit:{autofit:"自動調整",contents:"自動調整成內容大小",window:"自動調整成視窗大小",fixed:"固定欄寬"},resize:{rowHeight:"列高 (px)",colWidth:"欄寬 (px)"},apply:"套用",addDeleteRowCOl:"欄/列(插入/刪除)",areaReset:"清除格式",message:"<b>取消合併儲存格才可使用</br>"}},"en-US":{jTable:{borderColor:"Border color",merge:{merge:"cell merge",colspan:"colspan",rowspan:"rowspan",split:"cell split"},align:{top:"top",middle:"middle",bottom:"bottom",baseline:"baseline"},info:{info:"table info",margin:"margin"},autofit:{autofit:"autofit",contents:"autofit contents",window:"autofit window",fixed:"fixed column"},resize:{rowHeight:"row height (px)",colWidth:"col width (px)"},apply:"apply",addDeleteRowCOl:"Row/Col(Add/Del)",areaReset:"area Reset",message:"<b>Available after unmerge<br/>current or surrounding cells</br>"}},"ko-KR":{jTable:{borderColor:"선색",merge:{merge:"셀 합치기",colspan:"가로",rowspan:"세로",split:"셀 나누기"},align:{top:"위쪽 정렬",middle:"가운데 정렬",bottom:"아래쪽 정렬",baseline:"기본 정렬"},info:{info:"테이블 정보",margin:"여백"},apply:"적용",addDeleteRowCOl:"행/열(추가/삭제)",areaReset:"넓이/높이 초기화",message:"<b>현재 또는 주위 셀<br/>병합 해제 후 사용 가능</b>"}}}),e.extend(!0,e.summernote,{plugins:{jTable:function(o){var n,r,l=this,i=e.summernote.dom,s=e.summernote.ui,u=o.modules,f=o.options,p=(o.layoutInfo.editable,o.layoutInfo.toolbar),b=f.langInfo,g=navigator.userAgent,v=/MSIE|Trident/i.test(g),m=/Edge\/\d+/.test(g),h=(!m&&/firefox/i.test(g),!m&&/firefox/i.test(g),/PhantomJS/i.test(g),!m&&/webkit/i.test(g),!m&&/chrome/i.test(g),!m&&/safari/i.test(g)&&/chrome/i.test(g),{pressed:!1,rightFlag:!1,bottomFlag:!1,currentTableEl:void 0,currentTrEl:void 0,firstTdEl:void 0,colEl:void 0,currentTdEl:void 0,currentTdLeft:void 0,currentTdRight:void 0,currentTdTop:void 0,currentTdBottom:void 0,startX:void 0,startWidth:void 0,startY:void 0,startHeight:void 0,contenteditable:!1}),w={pressed:!1,currentTableEl:void 0,currentTdEl:void 0,currentTdLeft:void 0,currentTdRight:void 0,currentTdTop:void 0,currentTdBottom:void 0,currentTdPosition:{row:void 0,col:void 0},width:void 0,height:void 0,top:void 0,left:void 0,effect:{row:{start:void 0,end:void 0},col:{start:void 0,end:void 0}}},C=[s.button({className:"btn-md",contents:s.icon(f.icons.rowAbove),tooltip:b.table.addRowAbove,container:f.container,click:o.createInvokeHandler("jTable.jAddRow","top")}),s.button({className:"btn-md",contents:s.icon(f.icons.rowBelow),tooltip:b.table.addRowBelow,container:f.container,click:o.createInvokeHandler("jTable.jAddRow","bottom")}),s.button({className:"btn-md",contents:s.icon(f.icons.colBefore),tooltip:b.table.addColLeft,container:f.container,click:o.createInvokeHandler("jTable.jAddCol","left")}),s.button({className:"btn-md",contents:s.icon(f.icons.colAfter),tooltip:b.table.addColRight,container:f.container,click:o.createInvokeHandler("jTable.jAddCol","right")})],j=[s.button({className:"btn-md",contents:s.icon(f.icons.rowRemove),tooltip:b.table.delRow,container:f.container,click:o.createInvokeHandler("jTable.jDeleteRow")}),s.button({className:"btn-md",contents:s.icon(f.icons.colRemove),tooltip:b.table.delCol,container:f.container,click:o.createInvokeHandler("jTable.jDeleteCol")})];l.recoverPopover=function(t){var o=e(t.target).closest("button"),n=o.closest(".dropdown-toggle"),r=u.editor.getLastRange.call(u.editor),l=i.ancestor(r.ec,i.isCell);if(o.closest(".popover").length){var a=o.closest(".popover").css("left"),s=o.closest(".popover").css("top"),c=o.outerHeight();setTimeout((function(){u.tablePopover.update(l);var e=o.closest(".popover"),t=n.next(".dropdown-menu");e.css({left:a,top:s}),t.css({transform:"translate3d(0px, ".concat(c,"px, 0px)")})}),0)}},o.memo("button.jAddDeleteRowCol",(function(){return s.buttonGroup({className:"jtable-add-del-row-col jtable-display",children:[s.button({className:"dropdown-toggle",contents:s.dropdownButtonContents(s.icon(f.icons.rowAbove),f),tooltip:b.jTable.addDeleteRowCOl,container:f.container,data:{toggle:"dropdown"},click:function(o){var n=e(this).closest(".jtable-add-del-row-col"),r=n.find(".btn-md"),a=!1,s=u.editor.getLastRange.call(u.editor);if(s.isCollapsed()&&s.isOnCell()){var c=i.ancestor(s.commonAncestor(),i.isCell);if(!(a=c.rowSpan>1||c.colSpan>1)){for(var d=e(c).closest("table"),f=e(c).closest("tr")[0].rowIndex,p=new t(c,void 0,void 0,d[0]).getMatrixTable(),b=p[f],g=0,v=0;v<b.length;v++)(h=b[v]).isVirtual||c!=h.baseCell||(g=v),(h.baseCell.colSpan>1||h.baseCell.rowSpan>1)&&(a=!0);for(var m=0;m<p.length;m++){var h;((h=p[m][g]).baseCell.colSpan>1||h.baseCell.rowSpan>1)&&(a=!0)}}}r.toggleClass("disabled",a),r.attr("disabled",a);var w=n.find(".jtable-add-row-col-button-group, .jtable-del-row-col-button-group"),C=n.find(".jtable-dropdown-message"),j=n.find(".jtable-add-del-row-col-dropdown");a?(w.hide(),C.show()):(w.show(),C.hide(),j.css("width","")),l.recoverPopover(o)}}),s.dropdown({className:"jtable-add-del-row-col-dropdown",children:[s.button({className:"jtable-dropdown-message",contents:b.jTable.message,container:f.container}),s.buttonGroup({className:"jtable-add-row-col-button-group",children:C}),s.buttonGroup({className:"jtable-del-row-col-button-group",children:j})]})]}).render()})),l.jAddRow=function(e){var t=u.editor.getLastRange.call(u.editor);if(t.isCollapsed()&&t.isOnCell()){l.beforeCommand();var o=i.ancestor(t.commonAncestor(),i.isCell);l.addRow(o,e),l.afterCommand()}},l.addRow=function(o,n){for(var r=e(o).closest("tr"),a=l.recoverAttributes(r),s=e("<tr"+a+"></tr>"),c=new t(o,t.where.Row,t.requestAction.Add,e(r).closest("table")[0]).getActionList(),d=0;d<c.length;d++){var u=c[d],f=l.recoverAttributes(u.baseCell);switch(u.action){case t.resultAction.AddCell:s.append("<td"+f+">"+i.blank+"</td>");break;case t.resultAction.SumSpanCount:if("top"===n&&(u.baseCell.parent?u.baseCell.closest("tr").rowIndex:0)<=r[0].rowIndex){var p=e("<div></div>").append(e("<td"+f+">"+i.blank+"</td>").removeAttr("rowspan")).html();s.append(p);break}var b=parseInt(u.baseCell.rowSpan,10);b++,u.baseCell.setAttribute("rowSpan",b)}}if("top"===n)r.before(s);else{if(o.rowSpan>1){var g=r[0].rowIndex+(o.rowSpan-2);return void e(e(r).parent().find("tr")[g]).after(e(s))}r.after(s)}},l.jAddCol=function(e){var t=u.editor.getLastRange.call(u.editor);if(t.isCollapsed()&&t.isOnCell()){l.beforeCommand();var o=i.ancestor(t.commonAncestor(),i.isCell);l.addCol(o,e),l.afterCommand()}},l.addCol=function(o,n){for(var r=e(o).closest("tr"),a=e(r).closest("table").find("colgroup").children("col"),s=r.children().index(e(o)),c=new t(o,t.where.Column,t.requestAction.Add,e(r).closest("table")[0]).getActionList(),d=0;d<c.length;d++){var u=c[d],f=l.recoverAttributes(u.baseCell);switch(u.action){case t.resultAction.AddCell:"right"===n?e(u.baseCell).after("<td"+f+">"+i.blank+"</td>"):e(u.baseCell).before("<td"+f+">"+i.blank+"</td>");break;case t.resultAction.SumSpanCount:var p=parseInt(u.baseCell.colSpan,10);p++,u.baseCell.setAttribute("colSpan",p)}}if(a.length){for(var b=0;b<a.length;b++){var g=a[b],v=g.span;for(g.span=1;v>1;)e(g).after(e(g).prop("outerHTML")),v-=1}var m=a[s],h=l.recoverAttributes(m),w=e("<col"+h+"/>");w.width(100),"right"===n?e(m).after(w[0]):e(m).before(w[0])}},l.jDeleteRow=function(){var o=u.editor.getLastRange.call(u.editor);if(o.isCollapsed()&&o.isOnCell()){l.beforeCommand();for(var n=i.ancestor(o.commonAncestor(),i.isCell),r=e(n).closest("tr"),a=r.children("td, th").index(e(n)),s=r[0].rowIndex,c=new t(n,t.where.Row,t.requestAction.Delete,e(r).closest("table")[0]).getActionList(),d=0;d<c.length;d++)if(c[d]){var f=c[d].baseCell,p=c[d].virtualTable,b=f.rowSpan&&f.rowSpan>1,g=b?parseInt(f.rowSpan,10):0;switch(c[d].action){case t.resultAction.Ignore:continue;case t.resultAction.AddCell:var v=r.next("tr")[0];if(!v)continue;var m=r[0].cells[a];b&&(g>2?(g--,v.insertBefore(m,v.cells[a]),v.cells[a].setAttribute("rowSpan",g),v.cells[a].innerHTML=""):2===g&&(v.insertBefore(m,v.cells[a]),v.cells[a].removeAttribute("rowSpan"),v.cells[a].innerHTML=""));continue;case t.resultAction.SubtractSpanCount:b&&(g>2?(g--,f.setAttribute("rowSpan",g),p.rowIndex!==s&&f.cellIndex===a&&(f.innerHTML="")):2===g&&(f.removeAttribute("rowSpan"),p.rowIndex!==s&&f.cellIndex===a&&(f.innerHTML="")));continue;case t.resultAction.RemoveCell:continue}}r.remove(),l.afterCommand()}},l.jDeleteCol=function(){var o=u.editor.getLastRange.call(u.editor);if(o.isCollapsed()&&o.isOnCell()){l.beforeCommand();for(var n=i.ancestor(o.commonAncestor(),i.isCell),r=e(n).closest("tr"),a=r.children("td, th").index(e(n)),s=e(r).closest("table").find("colgroup").children("col"),c=r.children().index(e(n)),d=new t(n,t.where.Column,t.requestAction.Delete,e(r).closest("table")[0]).getActionList(),f=0;f<d.length;f++)if(d[f])switch(d[f].action){case t.resultAction.Ignore:continue;case t.resultAction.SubtractSpanCount:var p=d[f].baseCell;if(p.colSpan&&p.colSpan>1){var b=p.colSpan?parseInt(p.colSpan,10):0;b>2?(b--,p.setAttribute("colSpan",b),p.cellIndex===a&&(p.innerHTML="")):2===b&&(p.removeAttribute("colSpan"),p.cellIndex===a&&(p.innerHTML=""))}continue;case t.resultAction.RemoveCell:i.remove(d[f].baseCell,!0);continue}if(s.length){var g=s[c];e(g).remove()}l.afterCommand()}},l.recoverAttributes=function(e){var t="";if(!e)return t;for(var o=e.attributes||[],n=0;n<o.length;n++)"id"!==o[n].name.toLowerCase()&&("span"===o[n].name.toLowerCase()&&"col"==e.tagName.toLowerCase()||o[n].specified&&(t+=" "+o[n].name+"='"+o[n].value+"'"));return t},l.beforeCommand=function(){u.editor.beforeCommand.call(u.editor)},l.afterCommand=function(){u.editor.afterCommand.call(u.editor)},o.memo("button.jTable",(function(){return s.buttonGroup([s.button({className:"dropdown-toggle",contents:s.dropdownButtonContents(s.icon(f.icons.table),f),tooltip:b.table.table,container:f.container,data:{toggle:"dropdown"},click:function(e){l.recoverPopover(e)}}),s.dropdown({title:b.table.table,className:"note-table",items:['<div class="note-dimension-picker">','<div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div>','<div class="note-dimension-picker-highlighted"></div>','<div class="note-dimension-picker-unhighlighted"></div>',"</div>",'<div class="note-dimension-display">1 x 1</div>'].join("")})],{callback:function(e){e.find(".note-dimension-picker-mousecatcher").css({width:f.insertTableMaxSize.col+"em",height:f.insertTableMaxSize.row+"em"}).mousedown(o.createInvokeHandler("jTable.insertTable")).on("mousemove",u.buttons.tableMoveHandler.bind(o))}}).render()})),l.insertTable=function(e){l.beforeCommand();var t=e.split("x"),o=u.editor.getLastRange().deleteContents(),n=l.createTable(t[0],t[1],f);o.insertNode(n),l.afterCommand()},l.createTable=function(t,o,n){for(var r,l,a=[],s=[],c=0;c<t;c++)s.push("<td>"+i.blank+"</td>"),a.push('<col style="width: 100px;"/>');r="<colgroup>"+a.join("")+"</colgroup>",l=s.join("");for(var d,u=[],f=0;f<o;f++)u.push("<tr>"+l+"</tr>");d=u.join("");var p=e('<table class="jtable-expanded" style="width: auto !important;">'+r+d+"</table>");return n&&n.tableClassName&&p.addClass(n.tableClassName),p[0]},o.memo("button.jBorderColor",(function(){return l.colorPalette("note-color-table-border",b.jTable.borderColor,l.jBorderColor)})),l.jBorderColor=function(t){l.beforeCommand();var o=w.currentTdEl;if(!o)return l.afterCommand();e(o).closest("table").find("td, th").css("border","1px solid "+t),l.afterCommand()},o.memo("button.jBackcolor",(function(){return l.colorPalette("note-color-back",b.color.background,l.color)})),l.color=function(o){l.beforeCommand();var n=w.currentTdEl;if(!n)return l.afterCommand();for(var r=e(n).closest("table"),a=new t(n,void 0,void 0,r[0]).getMatrixTable(),i=w.effect.row,s=w.effect.col,c=i.start;c<=i.end;c++)for(var d=s.start;d<=s.end;d++){var u=a[c][d];e(u.baseCell).css("background-color",o)}l.afterCommand()},l.colorPalette=function(t,o,n){return s.buttonGroup({className:"note-color jtable-display "+t,children:[s.button({className:"note-current-color-button note-table-color",contents:s.icon(f.icons.font+" note-recent-color"),tooltip:o,container:f.container,click:function(t){var o=e(t.currentTarget).attr("data-backColor");n(o)},callback:function(e){var o=e.find(".note-recent-color");o.css("background-color","note-color-table-border"==t?"#000000":f.colorButton.backColor),e.attr("data-backColor","note-color-table-border"==t?"#000000":f.colorButton.backColor),o.css("color","transparent")}}),s.button({className:"dropdown-toggle",contents:s.dropdownButtonContents("",f),tooltip:b.color.more,container:f.container,data:{toggle:"dropdown"},click:function(e){l.recoverPopover(e)}}),s.dropdown({items:['<div class="note-palette">','<div class="note-palette-title">'+o+"</div>","<div>",'<button type="button" class="note-color-reset btn btn-light" data-event="backColor" data-value="inherit">',b.color.transparent,"</button>","</div>",'<div class="note-holder" data-event="backColor"/>',"<div>"].join(""),callback:function(t){t.find(".note-holder").each((function(t,o){var n=e(o);n.append(s.palette(d({colors:f.colors,colorsName:f.colorsName,eventName:n.data("event"),container:f.container,tooltip:f.tooltip},"container",f.container)).render())}));var o=[["#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"]];t.find(".note-holder-custom").each((function(t,n){var r=e(n);r.append(s.palette(d({colors:o,colorsName:o,eventName:r.data("event"),container:f.container,tooltip:f.tooltip},"container",f.container)).render())})),t.find("input[type=color]").each((function(o,n){e(n).change((function(){var o=t.find("#"+e(this).data("event")).find(".note-color-btn").first(),n=this.value.toUpperCase();o.css("background-color",n).attr("aria-label",n).attr("data-value",n).attr("data-original-title",n),o.click()}))}))},click:function(t){var o=e(this).closest(".note-popover").find(".note-dropdown-menu"),r=e(t.target),l=r.data("event"),a=r.attr("data-value");if("openPalette"===l){var i=o.find("#"+a),s=e(o.find("#"+i.data("event")).find(".note-color-row")[0]),c=s.find(".note-color-btn").last().detach(),d=i.val();c.css("background-color",d).attr("aria-label",d).attr("data-value",d).attr("data-original-title",d),s.prepend(c),i.click()}else{var u="backColor"===l?"background-color":"color",f=r.closest(".note-color").find(".note-recent-color"),p=r.closest(".note-color").find(".note-current-color-button");f.css(u,a),p.attr("data-"+l,a),n(a)}}})]}).render()},l.setCellHorizontalAlign=function(o){l.beforeCommand();for(var n=w.currentTdEl,r=e(n).closest("table"),a=new t(n,void 0,void 0,r[0]).getMatrixTable(),i=w.effect.row,s=w.effect.col,c=i.start;c<=i.end;c++)for(var d=s.start;d<=s.end;d++){var u=a[c][d];e(u.baseCell).css("text-align",o)}l.afterCommand()},l.setCellVerticalAlign=function(o){l.beforeCommand();for(var n=w.currentTdEl,r=e(n).closest("table"),a=new t(n,void 0,void 0,r[0]).getMatrixTable(),i=w.effect.row,s=w.effect.col,c=i.start;c<=i.end;c++)for(var d=s.start;d<=s.end;d++){var u=a[c][d];e(u.baseCell).css("vertical-align",o)}l.afterCommand()};var x=[s.button({contents:s.icon(f.icons.alignLeft),tooltip:b.paragraph.left,container:f.container,click:o.createInvokeHandler("jTable.setCellHorizontalAlign","left")}),s.button({contents:s.icon(f.icons.alignCenter),tooltip:b.paragraph.center,container:f.container,click:o.createInvokeHandler("jTable.setCellHorizontalAlign","center")}),s.button({contents:s.icon(f.icons.alignRight),tooltip:b.paragraph.right,container:f.container,click:o.createInvokeHandler("jTable.setCellHorizontalAlign","right")}),s.button({contents:s.icon(f.icons.alignJustify),tooltip:b.paragraph.justify,container:f.container,click:o.createInvokeHandler("jTable.setCellHorizontalAlign","justify")})],T=[s.button({className:"jtable-vertical-align-btn-top",contents:s.icon(f.icons.alignJustify),tooltip:b.jTable.align.top,container:f.container,click:o.createInvokeHandler("jTable.setCellVerticalAlign","top")}),s.button({className:"jtable-vertical-align-btn-middle",contents:s.icon(f.icons.alignJustify),tooltip:b.jTable.align.middle,container:f.container,click:o.createInvokeHandler("jTable.setCellVerticalAlign","middle")}),s.button({className:"jtable-vertical-align-btn-bottom",contents:s.icon(f.icons.alignJustify),tooltip:b.jTable.align.bottom,container:f.container,click:o.createInvokeHandler("jTable.setCellVerticalAlign","bottom")}),s.button({className:"jtable-vertical-align-btn-baseline",contents:s.icon(f.icons.alignJustify),tooltip:b.jTable.align.baseline,container:f.container,click:o.createInvokeHandler("jTable.setCellVerticalAlign","baseline")})];o.memo("button.jAlign",(function(){return s.buttonGroup([s.button({className:"dropdown-toggle jtable-display",contents:s.dropdownButtonContents(s.icon(f.icons.alignLeft),f),tooltip:b.paragraph.paragraph,container:f.container,data:{toggle:"dropdown"},click:function(e){l.recoverPopover(e)}}),s.dropdown({className:"jtable-align-dropdown",children:[s.buttonGroup({className:"jtable-horizontal-align-button-group",children:x}),s.buttonGroup({className:"jtable-vertical-align-button-group",children:T})]})],{callback:function(e){}}).render()})),o.memo("button.jAutoFit",(function(){var e='<svg width="16" height="20" viewBox="0 0 20 25" xmlns="http://www.w3.org/2000/svg">\n                    <path stroke="null" d="m0.40456,23.71451l0,-15.4604l5.98412,0l1.2128,0l4.79816,0l1.21167,0l5.98412,0l0,15.4604l-19.19087,0l0,0zm13.20675,-1.18003l4.79577,0l0,-3.56933l-4.79577,0l0,3.56933zm4.79577,-4.75652l0,-3.56102l-4.79577,0l0,3.56102l4.79577,0zm-10.80559,4.75652l4.79816,0l0,-3.56933l-4.79816,0l0,3.56933zm4.79816,-4.75652l0,-3.56102l-4.79816,0l0,3.56102l4.79816,0zm-10.80406,4.75652l4.7931,0l0,-3.56933l-4.7931,0l0,3.56933zm4.7931,-4.75652l0,-3.56102l-4.7931,0l0,3.56102l4.7931,0zm-4.7931,-8.32662l0,3.57783l4.7931,0l0,-3.57783l-4.7931,0zm6.0059,0l0,3.57783l4.79816,0l0,-3.57783l-4.79816,0zm6.00982,0l0,3.57783l4.79577,0l0,-3.57783l-4.79577,0z" class="cls-1" fill="#000" fill-rule="evenodd"/>\n                    <line stroke="#000" x1="0.99834" y1="1.28549" x2="0.99834" y2="7.9574" id="svg_6"/>\n                    <line stroke="#000" x1="19.04735" y1="1.28549" x2="19.04735" y2="7.9574" id="svg_5"/>\n                    <line stroke="#000" x1="6.61898" y1="4.69242" x2="1.08942" y2="4.69242" id="svg_4"/>\n                    <line stroke="#000" x1="18.96992" y1="4.69242" x2="13.44035" y2="4.69242" id="svg_3"/>\n                    <line stroke="#007fff" x1="7.64112" y1="2.12549" x2="12.35887" y2="6.84324" id="svg_2"/>\n                    <line stroke="#007fff" x1="12.40457" y1="2.07979" x2="7.68682" y2="6.79754" id="svg_1"/>\n                </svg>',t='<svg width="16" height="20" viewBox="0 0 20 25" xmlns="http://www.w3.org/2000/svg">\n                <text stroke-width="0" font-weight="bold" xml:space="preserve" text-anchor="start" font-family="Noto Sans JP" font-size="7" id="svg_3" y="7" x="6.51394" stroke="#007fff" fill="#007fff">%</text>\n                    <path stroke="null" id="svg_4" d="m0.17556,24.29515l0,-15.82937l6.12694,0l1.24175,0l4.91267,0l1.24058,0l6.12694,0l0,15.82937l-19.64887,0l0,0zm13.52193,-1.20819l4.91022,0l0,-3.65452l-4.91022,0l0,3.65452zm4.91022,-4.87004l0,-3.64601l-4.91022,0l0,3.64601l4.91022,0zm-11.06347,4.87004l4.91267,0l0,-3.65452l-4.91267,0l0,3.65452zm4.91267,-4.87004l0,-3.64601l-4.91267,0l0,3.64601l4.91267,0zm-11.0619,4.87004l4.90749,0l0,-3.65452l-4.90749,0l0,3.65452zm4.90749,-4.87004l0,-3.64601l-4.90749,0l0,3.64601l4.90749,0zm-4.90749,-8.52534l0,3.66321l4.90749,0l0,-3.66321l-4.90749,0zm6.14923,0l0,3.66321l4.91267,0l0,-3.66321l-4.91267,0zm6.15325,0l0,3.66321l4.91022,0l0,-3.66321l-4.91022,0z" class="cls-1" fill="#000" fill-rule="evenodd"/>\n                    <line stroke="#000" x1="0.78351" y1="1.33085" x2="0.78351" y2="8.16198" id="svg_1"/>\n                    <line stroke="#000" x1="19.26327" y1="1.33085" x2="19.26327" y2="8.16198" id="svg_2"/>\n                    <line stroke="#000" x1="6.53829" y1="4.81908" x2="0.87676" y2="4.81908" id="svg_9"/>\n                    <line stroke="#000" x1="19.18399" y1="4.81909" x2="13.52246" y2="4.81909" id="svg_10"/>\n                </svg>',n='<svg width="16" height="20" viewBox="0 0 20 25" xmlns="http://www.w3.org/2000/svg">\n                    <path stroke="null" id="svg_4" d="m0.49693,23.60655l0,-15.31157l5.92652,0l1.20113,0l4.75197,0l1.2,0l5.92652,0l0,15.31157l-19.00613,0l0,0zm13.07961,-1.16867l4.7496,0l0,-3.53497l-4.7496,0l0,3.53497zm4.7496,-4.71073l0,-3.52674l-4.7496,0l0,3.52674l4.7496,0zm-10.70157,4.71073l4.75197,0l0,-3.53497l-4.75197,0l0,3.53497zm4.75197,-4.71073l0,-3.52674l-4.75197,0l0,3.52674l4.75197,0zm-10.70005,4.71073l4.74696,0l0,-3.53497l-4.74696,0l0,3.53497zm4.74696,-4.71073l0,-3.52674l-4.74696,0l0,3.52674l4.74696,0zm-4.74696,-8.24647l0,3.54339l4.74696,0l0,-3.54339l-4.74696,0zm5.94809,0l0,3.54339l4.75197,0l0,-3.54339l-4.75197,0zm5.95197,0l0,3.54339l4.7496,0l0,-3.54339l-4.7496,0z" class="cls-1" fill="#000" fill-rule="evenodd"/>\n                    <line stroke="#000" x1="0.88616" y1="1.39345" x2="0.88616" y2="8.00112" id="svg_1"/>\n                    <line stroke="#000" x1="18.76142" y1="1.39345" x2="18.76142" y2="8.00112" id="svg_2"/>\n                    <line stroke="#007fff" x1="2.92815" y1="4.38208" x2="2.92815" y2="7.32357" id="svg_14"/>\n                    <line stroke="#007fff" x1="5.19084" y1="4.38208" x2="5.19084" y2="7.32357" id="svg_15"/>\n                    <line stroke="#007fff" x1="7.45353" y1="4.38208" x2="7.45353" y2="7.32357" id="svg_16"/>\n                    <line stroke="#007fff" x1="9.71623" y1="4.38208" x2="9.71623" y2="7.32357" id="svg_17"/>\n                    <line stroke="#007fff" x1="11.97892" y1="4.38208" x2="11.97892" y2="7.32357" id="svg_22"/>\n                    <line stroke="#007fff" x1="14.24161" y1="4.38208" x2="14.24161" y2="7.32357" id="svg_23"/>\n                    <line stroke="#007fff" x1="16.5043" y1="4.38208" x2="16.5043" y2="7.32357" id="svg_27"/>\n                    <line stroke="#000" x1="18.67122" y1="7.4828" x2="1.11211" y2="7.4828" id="svg_13"/>\n                </svg>';return s.buttonGroup([s.button({className:"dropdown-toggle jtable-display",contents:'<i class="note-icon jtable-icon-autofit-contents">'.concat(e,"</i>"),tooltip:b.jTable.autofit.autofit,container:f.container,data:{toggle:"dropdown"},click:function(e){l.recoverPopover(e)}}),s.dropdown({className:"jtable-autofit-dropdown",children:[s.buttonGroup([s.button({className:"note-btn-jtable-autofit-contents",contents:'<i class="note-icon jtable-icon-autofit-contents">'.concat(e,"</i>"),tooltip:b.jTable.autofit.contents,container:f.container,click:o.createInvokeHandler("jTable.autofitContents")}),s.button({className:"note-btn-jtable-autofit-window",contents:'<i class="note-icon jtable-icon-autofit-window">'.concat(t,"</i>"),tooltip:b.jTable.autofit.window,container:f.container,click:o.createInvokeHandler("jTable.autofitWindow")}),s.button({className:"note-btn-jtable-fixed-column-width",contents:'<i class="note-icon jtable-icon-fixed-column-width">'.concat(n," </i>"),tooltip:b.jTable.autofit.fixed,container:f.container,click:o.createInvokeHandler("jTable.fixedColumnWidth")})])]})]).render()})),l.autofitContents=function(){l.beforeCommand();var t=u.editor.getLastRange.call(u.editor),o=e(i.ancestor(t.ec,i.isTable));o.css("width","auto"),o.find("colgroup col").css("width",""),q(o),l.afterCommand()},l.autofitWindow=function(){l.beforeCommand();var t=u.editor.getLastRange.call(u.editor),o=e(i.ancestor(t.ec,i.isTable));o.css("width","100%"),q(o),l.afterCommand()},l.fixedColumnWidth=function(){l.beforeCommand();var t=u.editor.getLastRange.call(u.editor),o=e(i.ancestor(t.ec,i.isTable));o.find("colgroup col").css("width",(function(){if(!this.style.width){var t=e(this).css("width");e(this).css("width",t||"100px")}})),o.css({overflowWrap:"anywhere",width:"auto"}),q(o),l.afterCommand()};var y=['<div class="form-group">','<label for="jtable-cell-merge-col'+f.id+'" class="note-form-label jtable-merge-label">'+b.jTable.merge.colspan+"</label>",'<input id="jtable-cell-merge-col'+f.id+'" class="note-input jtable-merge-input jtable-merge-col-input" type="number" name="col"/>','<span class="jtable-merge-hint-span">(min : <span class="jtable-merge-hint-col-min">1</span> / max : <span class="jtable-merge-hint-col-max">1</span>)</span>',"</div>",'<div class="form-group jtable-merge-row-info-div">','<label for="jtable-cell-merge-row'+f.id+'" class="note-form-label jtable-merge-label">'+b.jTable.merge.rowspan+"</label>",'<input id="jtable-cell-merge-row'+f.id+'" class="note-input jtable-merge-input jtable-merge-row-input" type="number" name="row"/>','<span class="jtable-merge-hint-span">(min : <span class="jtable-merge-hint-row-min">1</span> / max : <span class="jtable-merge-hint-row-max">1</span>)</span>',"</div>"].join(""),k='<input type="button" href="#" class="btn btn-primary note-btn note-btn-primary jtable-merge-btn" value="'+b.jTable.merge.merge+'" disabled>';(n=s.dialog({title:b.jTable.merge.merge,fade:f.dialogsFade,body:y,footer:k}).render().appendTo(f.container)).find(".note-modal-content").width(340),n.find(".note-modal-body").css("padding","20px 20px 10px 20px");var A=[s.button({contents:s.icon("note-icon-table-merge"),tooltip:b.jTable.merge.merge,container:f.container,click:o.createInvokeHandler("jTable.cellMerge")}),s.button({className:"note-btn-jtable-cell-split",contents:s.icon("note-icon-table-cell-split"),tooltip:b.jTable.merge.split,container:f.container,click:o.createInvokeHandler("jTable.cellSplit")})];function S(t,o){l.beforeCommand();var n=e(t),r=o.merge.col-o.current.col,a=o.merge.row-o.current.row;n.prop("colspan",o.merge.col);for(var i=0;i<r;i++)e(o.effect.col[i]).remove();for(n.prop("rowspan",o.merge.row),i=0;i<a;i++){var s=o.effect.row[i];if(r>0)for(var c=0;c<r;c++)e(s).next().remove();e(s).remove()}var d=n.closest("table"),u=d.children("tr");for(u.length||(u=d.children("tbody").children("tr")),i=0;i<u.length;i++){var f=e(u[i]);f.find("td, th").length||f.remove()}l.afterCommand()}function I(o){for(var n=e(o),r=n.closest("table"),l=n.closest("tr"),a=parseInt(o.colSpan,10),i=parseInt(o.rowSpan,10),s=a-1,c=l[0].rowIndex,d=c+i-1,u=new t(o,void 0,void 0,r[0]),f=u.getMatrixTable(),p=(u.getColCount(),!1),b=[],g=c;g<=d;g++){for(var v=f[g],m=0;m<v.length;m++){if(p&&o!=v[m].baseCell&&!v[m].isVirtual){if(b.push(v[m].baseCell),g==c)for(var h=0;h<s;h++)e(v[m].baseCell).before(e("<td/>"));else for(h=0;h<a;h++)e(v[m].baseCell).before(e("<td/>"));break}if(o==v[m].baseCell&&(p=!0),p&&m==v.length-1){var w=v[m].baseCell;if(g==c)for(h=0;h<s;h++)e(w).after(e("<td/>"));else{var C=r.children("tr");for(C.length||(C=C.children("tbody").children("tr")),w=e(C[g]).children().last(),h=0;h<a;h++)e(w).after(e("<td/>"))}}}p=!1}n.prop("colspan",1),n.prop("rowspan",1)}function R(o){var n=e(o).closest("table"),r=e(o).closest("tr")[0].rowIndex,l=new t(o,void 0,void 0,n[0]).getMatrixTable(),a=l[r],i=0,s=!1,c=1,d=[];if(o.rowSpan>1)c=o.colSpan;else for(var u=0;u<a.length;u++){var f=a[u];s&&(d.push(f.baseCell),c++),s||o!=f.baseCell?s&&(f.baseCell.colSpan>1||f.baseCell.rowSpan>1)&&(c--,d.pop(),s=!1):(i=u,s=!0)}s=!1;var p=1,b=[];if(o.colSpan>1)p=o.rowSpan;else for(var g=0;g<l.length;g++)f=l[g][i],s&&(b.push(f.baseCell),p++),s||o!=f.baseCell?s&&(f.baseCell.colSpan>1||f.baseCell.rowSpan>1)&&(p--,b.pop(),s=!1):s=!0;return{trIndex:r,tdIndex:i,current:{col:o.colSpan,row:o.rowSpan},max:{col:c,row:p},effect:{col:d,row:b}}}o.memo("button.jMerge",(function(){return s.buttonGroup({className:"jtable-display",children:[s.button({className:"dropdown-toggle jtable-cell-split-dropdown-toggle",contents:s.dropdownButtonContents(s.icon("note-icon-table-merge"),f),tooltip:b.jTable.merge.merge,container:f.container,data:{toggle:"dropdown"},click:function(t){var o=e(this).parent().find(".note-btn-jtable-cell-split"),n=!1,r=u.editor.getLastRange.call(u.editor);if(r.isCollapsed()&&r.isOnCell()){var a=i.ancestor(r.commonAncestor(),i.isCell);n=a.rowSpan>1||a.colSpan>1}o.toggleClass("disabled",!n),o.attr("disabled",!n),l.recoverPopover(t)}}),s.dropdown({className:"jtable-cell-split-dropdown",children:[s.buttonGroup({className:"jtable-cell-split-button-group",children:A})]})]}).render()})),l.cellMerge=function(){"drag"==f.jTable.mergeMode?l.dragCellMerge():l.mergeDialogShow()},l.dragCellMerge=function(){var o=w.currentTdEl,n=e(o),r=n.closest("table"),l=new t(o,void 0,void 0,r[0]).getMatrixTable(),a=w.effect.row,i=w.effect.col;if(a.start==a.end&&i.start==i.end)return q(n),!0;for(var s=a.start;s<=a.end;s++)for(var c=i.start;c<=i.end;c++)I(l[s][c].baseCell);var d=R(o),u={trIndex:d.trIndex,colIndex:d.colIndex,current:{col:d.current.col,row:d.current.row},merge:{col:parseInt(i.end-i.start+1,10),row:parseInt(a.end-a.start+1,10)},effect:{col:d.effect.col,row:d.effect.row}};S(l[a.start][i.start].baseCell,u),q(n)},l.mergeDialogShow=function(){var t=u.editor.getLastRange.call(u.editor);if(t.isCollapsed()&&t.isOnCell()){var r=R(i.ancestor(t.commonAncestor(),i.isCell));u.tablePopover.hide(),o.invoke("editor.saveRange"),function(t){return e.Deferred((function(e){var r=n.find(".jtable-merge-input"),l=n.find(".jtable-merge-col-input"),a=n.find(".jtable-merge-hint-col-min"),i=n.find(".jtable-merge-hint-col-max"),c=n.find(".jtable-merge-row-input"),d=n.find(".jtable-merge-hint-row-min"),u=n.find(".jtable-merge-hint-row-max"),f=n.find(".jtable-merge-btn");l.val(t.current.col),a.text(t.current.col),i.text(t.max.col),c.val(t.current.row),d.text(t.current.row),u.text(t.max.row),s.onDialogShown(n,(function(){o.triggerEvent("dialog.shown"),r.on("input paste propertychange",(function(){var e=!1,o=parseInt(l.val(),10),n=parseInt(c.val(),10);o==t.current.col&&n==t.current.row?e=!1:o>=t.current.col&&o<=t.max.col&&n>=t.current.row&&n<=t.max.row&&(e=!0),s.toggleBtn(f,e)})),f.click((function(o){o.preventDefault(),e.resolve({trIndex:t.trIndex,colIndex:t.colIndex,current:{col:t.current.col,row:t.current.row},merge:{col:parseInt(l.val(),10),row:parseInt(c.val(),10)},effect:{col:t.effect.col,row:t.effect.row}})}))})),s.onDialogHidden(n,(function(){r.off(),f.off(),s.toggleBtn(f,!1),"pending"===e.state()&&e.reject()})),s.showDialog(n)}))}(r).then((function(e){s.hideDialog(n),o.invoke("editor.restoreRange"),S(i.ancestor(t.commonAncestor(),i.isCell),e)})).fail((function(){o.invoke("editor.restoreRange")}))}},l.cellSplit=function(){var e=u.editor.getLastRange.call(u.editor);e.isCollapsed()&&e.isOnCell()&&(l.beforeCommand(),I(i.ancestor(e.commonAncestor(),i.isCell)),l.afterCommand())};var H=['<div class="form-group form-group-jtable-table-info-margin">','<div class="jtable-table-info-margin-top-bottom"><input type="number" value="0" class="jtable-table-info-margin-input jtable-table-info-margin-input-top"><span>px</span></div>','<div class="jtable-table-info-margin-middle">','<div class="jtable-table-info-margin-left"><input type="number" value="0" class="jtable-table-info-margin-input jtable-table-info-margin-input-left"><span>px</span></div>','<div class="jtable-table-info-margin-center"><b>Table</b><br><span class="jtable-table-info-width">0</span> X <span class="jtable-table-info-height">0</span></div>','<div class="jtable-table-info-margin-right"><input type="number" value="0" class="jtable-table-info-margin-input jtable-table-info-margin-input-right"><span>px</span></div>',"</div>",'<div class="jtable-table-info-margin-top-bottom"><input type="number" value="0" class="jtable-table-info-margin-input jtable-table-info-margin-input-bottom"><span>px</span></div>',"</div>"].join(""),N='<input type="button" href="#" class="btn btn-primary note-btn note-btn-primary jtable-apply-btn" value="'+b.jTable.apply+'" >';function z(e,t,o){switch(e){case"width":t.width(o);break;case"height":t.children().height(o)}}function E(e,t){e.closest(".note-editing-area").css("cursor","auto"),e.closest(".note-editable").prop("contenteditable",t)}function F(){h={pressed:!1,rightFlag:!1,bottomFlag:!1,currentTableEl:void 0,firstTdEl:void 0,colEl:void 0,currentTdEl:void 0,currentTdLeft:void 0,currentTdRight:void 0,currentTdTop:void 0,currentTdBottom:void 0,startX:void 0,startWidth:void 0,startY:void 0,startHeight:void 0,contenteditable:!1}}function q(e){w={pressed:!1,currentTableEl:void 0,currentTdEl:void 0,currentTdLeft:void 0,currentTdRight:void 0,currentTdTop:void 0,currentTdBottom:void 0,currentTdPosition:{row:void 0,col:void 0},width:void 0,height:void 0,top:void 0,left:void 0,effect:{row:{start:void 0,end:void 0},col:{start:void 0,end:void 0}}},e.closest(".note-editing-area").find(".jtable-block").hide()}function P(e,o){for(var n=new t(e,void 0,void 0,o).getMatrixTable(),r=0;r<n.length;r++)for(var l=n[r],a=0;a<l.length;a++)if(n[r][a].baseCell==e)return{row:r,col:a}}(r=s.dialog({title:b.table.table+" "+b.jTable.info.margin,fade:f.dialogsFade,body:H,footer:N}).render().appendTo(f.container)).find(".note-modal-body").css("padding","20px 20px 10px 20px"),o.memo("button.jTableInfo",(function(){return s.button({className:"jtable-display",contents:s.icon("note-icon-table-margin"),tooltip:b.table.table+" "+b.jTable.info.margin,container:f.container,click:o.createInvokeHandler("jTable.tableInfoDialogShow")}).render()})),l.tableInfoDialogShow=function(){var t=u.editor.getLastRange.call(u.editor);if(t.isCollapsed()&&t.isOnCell()){var l=i.ancestor(t.commonAncestor(),i.isCell),a=e(l).closest("table");u.tablePopover.hide(),function(t){return e.Deferred((function(e){var l=r.find(".jtable-apply-btn"),a=r.find(".jtable-table-info-margin-input"),i=r.find(".jtable-table-info-margin-input-top"),c=r.find(".jtable-table-info-margin-input-left"),d=r.find(".jtable-table-info-margin-input-right"),u=r.find(".jtable-table-info-margin-input-bottom"),f=r.find(".jtable-table-info-width"),p=r.find(".jtable-table-info-height");i.val(parseInt(t.css("margin-top"),10)),c.val(parseInt(t.css("margin-left"),10)),d.val(parseInt(t.css("margin-right"),10)),u.val(parseInt(t.css("margin-bottom"),10)),f.text(t.width()),p.text(t.height()),s.onDialogShown(r,(function(){o.triggerEvent("dialog.shown"),a.on("input paste propertychange",(function(){var e=!0,t=parseInt(i.val(),10),o=parseInt(c.val(),10),n=parseInt(d.val(),10),r=parseInt(u.val(),10);(t<0||o<0||n<0||r<0)&&(e=!1),s.toggleBtn(l,e)})),l.click((function(t){o.invoke("beforeCommand"),t.preventDefault(),e.resolve([parseInt(i.val(),10)+"px",parseInt(d.val(),10)+"px",parseInt(u.val(),10)+"px",parseInt(c.val(),10)+"px"]),o.invoke("afterCommand")}))})),s.onDialogHidden(n,(function(){a.off(),l.off(),s.toggleBtn(l,!1),"pending"===e.state()&&e.reject()})),s.showDialog(r)}))}(a).then((function(e){s.hideDialog(r),o.invoke("editor.restoreRange"),a.css("margin",e.join(" "))})).fail((function(){o.invoke("editor.restoreRange")}))}},o.memo("button.jWidthHeightReset",(function(){return s.button({className:"jtable-display",contents:s.icon("note-icon-table-width-height-reset"),tooltip:b.table.table+" "+b.jTable.areaReset,container:f.container,click:o.createInvokeHandler("jTable.jWidthHeightReset")}).render()})),l.jWidthHeightReset=function(){var o=u.editor.getLastRange.call(u.editor);if(o.isCollapsed()&&o.isOnCell()){l.beforeCommand();var n=i.ancestor(o.commonAncestor(),i.isCell),r=e(n).closest("table");r.removeAttr("width"),r.removeAttr("height"),r.css("width","auto"),r.css("height","");var a=r.find("tr, td, th");a.removeAttr("width"),a.removeAttr("height"),a.css("width",""),a.css("height","");var s=new t(n,void 0,void 0,r[0]).getColCount();r.find("colgroup:first").remove();for(var c=e("<colgroup/>"),d=0;d<s;d++)c.append('<col style="width: 100px;"/>');r.prepend(c),l.afterCommand()}},o.memo("button.jRowHeight",(function(){var t=e("<div>").addClass(["input-group","input-group-sm","jtable-row-height-input-group","jtable-display"]),n=e("<div>").addClass("input-group-prepend"),r=e("<span>").addClass("input-group-text").append(e("<i>").addClass("jtable-icon-row-height").html('<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">\n                    <path transform="rotate(-90 5.31113 14.2238)" stroke-width="0" d="m5.48908,11q0.2111,0 0.37246,0.15312l0.31041,0.31041q0.15712,0.1572 0.15712,0.37653q0,0.22349 -0.15712,0.37246l-1.21252,1.21676l2.91344,0q0.21517,0 0.34959,0.15512q0.13457,0.1552 0.13457,0.37453l0,0.52974q0,0.21933 -0.13457,0.37453q-0.13441,0.1552 -0.34959,0.1552l-2.91344,0l1.21252,1.21668q0.15712,0.14897 0.15712,0.37246t-0.15712,0.37246l-0.31041,0.31041q-0.15728,0.1572 -0.37246,0.1572q-0.21925,0 -0.37661,-0.1572l-2.69403,-2.69411q-0.1532,-0.14489 -0.1532,-0.37246q0,-0.22349 0.1532,-0.37661l2.69403,-2.69411q0.16144,-0.15312 0.37661,-0.15312z" id="svg_5" stroke="#007fff" fill="#007fff"/>\n                    <path transform="rotate(90 5.31113 6.2238)" stroke-width="0" d="m5.48908,3q0.21109,0 0.37245,0.15312l0.31041,0.31041q0.15712,0.1572 0.15712,0.37653q0,0.22349 -0.15712,0.37246l-1.21252,1.21675l2.91344,0q0.21517,0 0.34959,0.15513q0.13457,0.1552 0.13457,0.37453l0,0.52974q0,0.21933 -0.13457,0.37453q-0.13442,0.15521 -0.34959,0.15521l-2.91344,0l1.21252,1.21667q0.15712,0.14897 0.15712,0.37246t-0.15712,0.37246l-0.31041,0.3104q-0.15728,0.1572 -0.37245,0.1572q-0.21925,0 -0.37661,-0.1572l-2.69403,-2.6941q-0.1532,-0.14489 -0.1532,-0.37246q0,-0.22349 0.1532,-0.37661l2.69403,-2.69411q0.16144,-0.15312 0.37661,-0.15312z" id="svg_3" stroke="#007fff" fill="#007fff"/>\n                    <rect x="13" y="3" width="4" height="14" id="svg_19" fill="#000000" fill-opacity="0" stroke="#000000"/>\n                    <rect x="8.5" y="17" width="3" height="0.1" id="svg_20" stroke="#000000"/>\n                    <rect x="8.5" y="3" width="3" height="0.1" id="svg_21" stroke="#000000"/>\n                </svg>'));n.append(r),t.append(n);var l=e('<input min="27" type=number />').addClass("jtable-row-height-input").css({width:"3em","line-height":"1em","text-align":"center",border:"1px solid #ced4da","border-radius":"0 0.2rem 0.2rem 0","font-size":"13px"});return l.on("focus",(function(e){o.invoke("editor.saveRange")})),l.on("blur",(function(e){o.invoke("editor.restoreRange")})),l.on("keydown",(function(t){if(13===t.keyCode){o.invoke("beforeCommand"),t.preventDefault();var n=e(t.target);o.invoke("jTable.setCellsWidthHeight","height",n.val()),o.invoke("afterCommand")}else 27===t.keyCode&&(o.invoke("beforeCommand"),t.preventDefault(),o.invoke("jTable.updateCellsWidthHeight"),o.invoke("afterCommand"))})),t.append(l),t.attr({title:b.jTable.resize.rowHeight,"aria-label":b.jTable.resize.rowHeight}).tooltip({container:f.container,trigger:"hover",placement:"bottom"}).on("click",(function(t){e(t.currentTarget).tooltip("hide")})),t})),o.memo("button.jColWidth",(function(){var t=e("<div>").addClass(["input-group","input-group-sm","jtable-col-width-input-group","jtable-display"]),n=e("<div>").addClass("input-group-prepend"),r=e("<span>").addClass("input-group-text").append(e("<i>").addClass("jtable-icon-col-width").html('<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">\n                    <path transform="rotate(-180 14.0889 14.2325)" fill="#007fff" stroke="#007fff" id="svg_5" d="m14.26689,11.00874q0.2111,0 0.37246,0.15312l0.31041,0.31041q0.15712,0.1572 0.15712,0.37653q0,0.22349 -0.15712,0.37246l-1.21252,1.21676l2.91344,0q0.21517,0 0.34959,0.15512q0.13457,0.1552 0.13457,0.37453l0,0.52974q0,0.21933 -0.13457,0.37453q-0.13441,0.1552 -0.34959,0.1552l-2.91344,0l1.21252,1.21668q0.15712,0.14897 0.15712,0.37246t-0.15712,0.37246l-0.31041,0.31041q-0.15728,0.1572 -0.37246,0.1572q-0.21925,0 -0.37661,-0.1572l-2.69403,-2.69411q-0.1532,-0.14489 -0.1532,-0.37246q0,-0.22349 0.1532,-0.37661l2.69403,-2.69411q0.16144,-0.15312 0.37661,-0.15312z" stroke-width="0"/>\n                    <path fill="#007fff" stroke="#007fff" id="svg_3" d="m6.26691,11.00873q0.21109,0 0.37245,0.15312l0.31041,0.31041q0.15712,0.1572 0.15712,0.37653q0,0.22349 -0.15712,0.37246l-1.21252,1.21675l2.91344,0q0.21517,0 0.34959,0.15513q0.13457,0.1552 0.13457,0.37453l0,0.52974q0,0.21933 -0.13457,0.37453q-0.13442,0.15521 -0.34959,0.15521l-2.91344,0l1.21252,1.21667q0.15712,0.14897 0.15712,0.37246t-0.15712,0.37246l-0.31041,0.3104q-0.15728,0.1572 -0.37245,0.1572q-0.21925,0 -0.37661,-0.1572l-2.69403,-2.6941q-0.1532,-0.14489 -0.1532,-0.37246q0,-0.22349 0.1532,-0.37661l2.69403,-2.69411q0.16144,-0.15312 0.37661,-0.15312z" stroke-width="0"/>\n                    <rect transform="rotate(-90 9.86516 4.54366)" stroke="#000000" fill-opacity="0" fill="#000000" id="svg_19" height="14" width="4" y="-2.45634" x="7.86516"/>\n                    <rect transform="rotate(-90 16.9152 9.54366)" stroke="#000000" id="svg_20" height="0.1" width="3" y="9.49367" x="15.41515"/>\n                    <rect transform="rotate(-90 2.91516 9.54366)" stroke="#000000" id="svg_21" height="0.1" width="3" y="9.49366" x="1.41516"/>\n                </svg>'));n.append(r),t.append(n);var l=e('<input min="27" type=number />').addClass("jtable-col-width-input").css({width:"3em","line-height":"1em","text-align":"center",border:"1px solid #ced4da","border-radius":"0 0.2rem 0.2rem 0","font-size":"13px"});return l.on("focus",(function(e){o.invoke("editor.saveRange")})),l.on("blur",(function(e){o.invoke("editor.restoreRange")})),l.on("keydown",(function(t){if(13===t.keyCode){o.invoke("beforeCommand"),t.preventDefault();var n=e(t.target);o.invoke("jTable.setCellsWidthHeight","width",n.val()),o.invoke("afterCommand")}else 27===t.keyCode&&(o.invoke("beforeCommand"),t.preventDefault(),o.invoke("jTable.updateCellsWidthHeight"),o.invoke("afterCommand"))})),t.append(l),t.attr({title:b.jTable.resize.colWidth,"aria-label":b.jTable.resize.colWidth}).tooltip({container:f.container,trigger:"hover",placement:"bottom"}).on("click",(function(t){e(t.currentTarget).tooltip("hide")})),t})),l.setCellsWidthHeight=function(o,n){var r=w.currentTdEl,l=e(r).closest("table"),a=new t(r,void 0,void 0,l[0]).getMatrixTable(),i=w.effect.row,s=w.effect.col;switch(o){case"width":for(var c=s.start;c<=s.end;c++)e(l.find("colgroup:first col")[c]).css("width",n);break;case"height":for(var d=i.start;d<=i.end;d++){var u=a[d][s.start];e(u.baseCell).closest("tr").find("td").css("height",n)}}q(l)},l.updateCellsWidthHeight=function(){var o=u.editor.getLastRange.call(u.editor),n=w.effect.row,r=w.effect.col,l=w.currentTdEl||i.ancestor(o.commonAncestor(),i.isCell);if(l){for(var a=p.find(".jtable-row-height-input"),s=p.find(".jtable-col-width-input"),c=e(l),d=c.closest("table"),f=new t(l,void 0,void 0,d[0]).getMatrixTable(),b=!1,g=c.css("height"),v=n.start;v<=n.end;v++){var m=f[v][r.start];e(m.baseCell).css("height")!==g&&(b=!0)}for(var h=!1,C=e(d.find("colgroup:first col")[r.start]).css("width"),j=r.start;j<=r.end;j++)e(d.find("colgroup:first col")[j]).css("width")!==C&&(h=!0);if(b)a.val("");else{var x=g?parseInt(g.replace(/\D/g,""),10):"";a.val(x)}if(h)s.val("");else{var T=C?parseInt(C.replace(/\D/g,""),10):"";s.val(T)}}},l.expandColgroup=function(e){for(var t="",o=e.closest("table"),n=0;n<e.length;n++){var r=e[n],l=r.span;r.removeAttribute("width");for(var a=r.offsetWidth,i=r.offsetHeight,s='style="width:'.concat(a,"px; height:").concat(i,'px"');l>0;)t=t.concat("<col ".concat(s," />")),l-=1}e.closest("colgroup").html(t),o.removeAttr("width"),o.css("width",""),o.css("table-layout","fixed")},l.events={"summernote.keyup summernote.mouseup summernote.change":function(){o.invoke("jTable.updateCellsWidthHeight")},"summernote.init":function(n,r){r.editingArea.append('<div class="jtable-block"><div/>'),r.toolbar.find(".jtable-display").hide(),r.editingArea.on("keydown",(function(o){if((o.metaKey||o.ctrlKey)&&"c"===String.fromCharCode(o.which).toLowerCase()){var n=e(o.target);if("block"==n.closest(".note-editing-area").find(".jtable-block").css("display")){var r=w.currentTableEl,l=w.effect,a=new t(this,void 0,void 0,r).getVirtualTable(),i=document.createElement("table");i.className=r.className,e(i).toggleClass("jtable-expanded",!1);for(var s=document.createElement("colgroup"),c=e(r).find("colgroup col"),d=0;d<a[0].length;d++){var u=a[0][d],f=document.createElement("col"),p=c[d].style.width?c[d].style.width:u.baseCell.style.width;f.style.width=p,s.appendChild(f)}i.appendChild(s);for(var b=l.row.start;b<=l.row.end;b++){for(var g=a[b],v=document.createElement("tr"),m=l.col.start,h=0;m<=l.col.end;m++,h++){var C=g[m];C.isVirtual||(v.style.width=s.childNodes[h].style.width,e(v).append(C.baseCell.outerHTML))}i.appendChild(v)}n.closest(".note-editor").after(i),e.summernote.range.createFromNode(i).select(),document.execCommand("copy"),e(i).remove()}}})),r.editingArea.on("paste",".note-editable",(function(o){var n=e(o.target).closest(".note-editable");setTimeout((function(){for(var o=n.find("table").not(".jtable-expanded"),r=0;r<o.length;r++){var a=e(o[r]);if(a.children("colgroup").children("col").length)s=a.children("colgroup").children("col"),l.expandColgroup(s),a.toggleClass("jtable-expanded",!0);else{for(var i=new t(this,void 0,void 0,o[r]).getVirtualTable(),s=document.createElement("colgroup"),c=0;c<i[0].length;c++){var d=i[0][c],u=document.createElement("col"),f=d.baseCell.style.width;if(d.baseCell.colSpan>1){var p=f.match(/([0-9]*)([a-z]*$)/);f=p[1]/d.baseCell.colSpan+p[2]}u.style.width=f,s.appendChild(u)}a.prepend(s)}}}),1)})),r.editingArea.on("paste",".note-editable",(function(o){setTimeout((function(){var n=e(o.target).closest(".note-editable"),r=n.closest(".note-editing-area").find(".jtable-block");if(!w.currentTableEl||!r[0]||"none"==r[0].style.display)return!0;var a=n.find("table.jtable-paste");if(a.length||(a=e(o.target).find("table")),!a.length)return!0;a.remove();var i=a.find("tr, td, th"),s=new t(i,void 0,void 0,a[0]).getMatrixTable(),c=s.length,d=s[0].length,u=w.currentTableEl,f=w.currentTdEl,p=w.effect.row,b=w.effect.col,g=p.end-p.start+1,v=b.end-b.start+1,m=0;if((m=c==g&&d==v?1:d>v||c>g?2:0)>0){if(2==m){for(var h=v;h<d;h++)l.addCol(f,"right");v=d;for(var C=g;C<c;C++)l.addRow(f,"bottom");g=c}for(var j=new t(f,void 0,void 0,u).getMatrixTable(),x=0;x<g;x++)for(var T=j[x+p.start],y=s[x].filter((function(e){return!e.isVirtual})),k=0;k<v;k++)(q=T[k+b.start])&&y[k]&&(q.baseCell.innerText=y[k].baseCell.innerText)}else{for(var A=[],S=0,I=0;I<s.length;I++)for(var R=s[I],H=0;H<R.length;H++){var N=R[H];A.push(N)}for(var z=0;z<g;z++)for(var E=u.rows[z+p.start],F=0;F<v;F++,S++){var q=E.cells[F+b.start];if(!A[S])break;q.innerText=A[S].baseCell.innerText}}r.hide()}),1)})),r.editingArea.on("click",(function(t){var o=e(t.target).closest(".note-editor").find(".note-toolbar .jtable-display");"none"==e(t.target).closest(".note-editable").next(".jtable-block").css("display")&&o.hide()})),r.editingArea.on("click",".note-editable table",(function(t){var o=e(t.target).closest("td");o.length||(o=e(t.target).closest("th")),o.length&&u.tablePopover.update(o[0]),e(t.target).closest(".note-editor").find(".note-toolbar .jtable-display").show(),t.stopPropagation()})),r.editingArea.on("mouseleave",".note-editable tr",(function(t){if(w.pressed)return!0;if(h.pressed)return!0;var o=e(this),n=o.closest(".note-editing-area").css("cursor");"row-resize"!=n&&"col-resize"!=n||o.closest(".note-editing-area").css("cursor","auto")})),r.editingArea.on("mousemove",".note-editable td,th",(function(t){if(w.pressed)return!0;if(h.pressed)return!0;var o=e(this),n=(o.closest("table"),o.closest("tr")),r=o.offset().left+o.outerWidth(),l=n.offset().top+o.outerHeight(),a=!1;r-5<=t.pageX&&(a=!0);var i,s=!1;l-5<=t.pageY&&(s=!0),i=a?"col-resize":s?"row-resize":"auto",o.closest(".note-editing-area").css("cursor",i)})),r.editingArea.on("mousedown","td",(function(t){if(w.pressed)return!0;var o=e(this);if(q(o),h.pressed)return!0;var n=o.closest("table"),r=o.offset().top,l=o.offset().left,a=l+o.outerWidth(),i=r+o.outerHeight(),s=P(this,n[0]);w={pressed:!0,currentTableEl:n[0],currentTdEl:this,currentTdLeft:l,currentTdRight:a,currentTdTop:r,currentTdBottom:i,currentTdPosition:{row:s.row,col:s.col},width:a,height:i,top:r,left:l,effect:{row:{start:s.row,end:s.row},col:{start:s.col,end:s.col}}},t.stopPropagation()})),r.editingArea.on("mouseup","td",(function(t){var o=e(this);if(!w.pressed)return!0;var n=o.closest("table"),r=P(this,n[0]),l=w.currentTdPosition.row<r.row||w.currentTdPosition.col<r.col,a=l?w.currentTdTop:o.offset().top,i=l?w.currentTdLeft:o.offset().left,s=o.outerWidth(),d=o.outerHeight(),f=l?w.currentTdRight:i+s,p=l?w.currentTdBottom:a+d;w=c(c({},w),{},{pressed:!1,currentTableEl:l?w.currentTableEl:n[0],currentTdEl:l?w.currentTdEl:this,currentTdLeft:i,currentTdRight:f,currentTdTop:a,currentTdBottom:p,currentTdPosition:{row:r.row,col:r.col},width:f,height:p,top:a,left:i});var b=e(t.target).closest("td");b.length||(b=e(t.target).closest("th")),b.length&&u.tablePopover.update(b[0])})),r.editingArea.on("mousemove",".note-editable",(function(t){if(!w.pressed)return!0;u.tablePopover.hide();var o=e(t.target).closest("td");o.length||(o=e(t.target).closest("th"));var n=o.closest(".note-editing-area").find(".jtable-block");if(o.length){var r=o.closest("table"),l=o.offset().top,a=o.offset().left,i=a+o.outerWidth(),s=l+o.outerHeight(),c=P(o[0],r[0]),d=w.effect.col,f=w.effect.row;w.currentTdLeft>=a?(w.left=a,w.width=w.currentTdRight-a,d.end=w.currentTdPosition.col,d.start=c.col):(w.width=i-w.left,d.end=c.col),w.currentTdTop>=l?(w.top=l,w.height=w.currentTdBottom-l,f.end=w.currentTdPosition.row,f.start=c.row):(w.height=s-w.top,f.end=c.row),n.show(),n.offset({left:w.left,top:w.top}),n.css({width:w.width,height:w.height})}})),r.editingArea.on("mousedown",".note-editable",(function(t){e(t.target).closest(".note-editable").next(".jtable-block").hide()})),r.editingArea.on("mousemove mousedown touchstart",".note-editable",(function(e){if(!w.pressed)return!0})),r.editingArea.on("mouseup",".note-editable",(function(t){if(v){var o=e("table.unselectable");o.toggleClass("unselectable",!1),o.attr("unselectable","off")}if(!w.pressed)return!0;w.pressed=!1}));var i=null;function s(){var o=e(this).closest(".note-editor").find("table"),n=new t(void 0,void 0,void 0,o[0]).getVirtualTable().map((function(e,t){return e.map((function(e){return i[t].reduce((function(t,o){return o.baseCell===e.baseCell||t}),!1)}))})),r=a(n),l=o.children("tbody"),s=(r.reduce((function(e,t,o){var r=-1,i=-1,s=!1;if(t.forEach((function(e,t){-1===r&&!1===e&&(r=t),r>-1&&!1===e&&r+1===t&&(s=!0,i=t),i>-1&&!1===e&&i+1===t&&(i=t)})),s){if(n=n.reduce((function(e,t,l){if(l===o){var s=n[o].filter((function(e,t){return!(t>=r&&t<=i)}));return[].concat(a(e),[s])}return[].concat(a(e),[t])}),[]),!l[0])return;l[0].childNodes[o].childNodes[r].remove(),l[0].childNodes[o].childNodes[r].colSpan=l[0].childNodes[o].childNodes[r].colSpan+1}return[].concat(a(e),[{tdIdxStart:r,tdIdxEnd:i,hasError:s}])}),[]),n.reduce((function(e,t,o){return t.length>=e.length&&t.reduce((function(e,t){return!t||e}),!1)?{trIdx:o,length:t.length}:e}),{trIdx:-1,length:0})),c=o.children("colgroup").children("col"),d=0;if(n[s.trIdx]){var u=n[s.trIdx].reduce((function(e,t){if(!t)return e+'<col style="width: 100px;" />';var o=e+c[d].outerHTML;return d++,o}),"");c.closest("colgroup").html(u),q(o)}}function d(){var o=e(this).closest(".note-editor").find("table"),n=new t(void 0,void 0,void 0,o[0]).getVirtualTable(),r=i.map((function(e,t){return e.map((function(e){return n[t].reduce((function(t,o){return o.baseCell===e.baseCell||t}),!1)}))})),l=r.reduce((function(e,t,o){return t.length>=e.length&&t.reduce((function(e,t){return!t||e}),!1)?{trIdx:o,length:t.length}:e}),{trIdx:-1,length:0}),a=o.children("colgroup").children("col");if(r[l.trIdx]){var s=r[l.trIdx].reduce((function(e,t,o){return t?e+a[o].outerHTML:e}),"");a.closest("colgroup").html(s),q(o)}}r.editor.on("click",'[aria-label="Add column left"]',s),r.editor.on("click",'[aria-label="左方插入欄"]',s),r.editor.on("click",'[aria-label="Add column right"]',s),r.editor.on("click",'[aria-label="右方插入欄"]',s),r.editor.on("click",'[aria-label="Delete column"]',d),r.editor.on("click",'[aria-label="刪除欄"]',d),r.editingArea.on("mousedown","td",(function(o){var n=e(this),r=n.closest("table"),a=new t(this,void 0,void 0,r[0]).getVirtualTable();i=a;var s=n.closest("tr"),c=n.offset().left,d=c+n.outerWidth(),f=s.offset().top,p=f+n.outerHeight(),b=!1;d-5<=o.pageX&&(b=!0);var g=!1;p-5<=o.pageY&&(g=!0);var m,w=n.closest(".note-editable").prop("contenteditable");if(!b&&!g)return E(n,w),void F();u.tablePopover.hide(),m=b?"col-resize":"row-resize",n.closest(".note-editing-area").css("cursor",m),n.closest(".note-editable").removeAttr("contenteditable");var C=r.children("colgroup").children("col");l.expandColgroup(C);for(var j=r.find("td"),x=0;x<j.length;x++){var T=j[x];T.width&&(T.width=""),T.style.width&&(T.style.width="")}for(var y=s[0].rowIndex,k=this.colSpan>1,A=a[y],S=0;S<A.length&&this!=A[S].baseCell;S++);k&&(S+=this.colSpan-1);var I=a[0][S].baseCell,R=r.find("colgroup:first col")[S],H=n.width();R&&(H=e(R).width()),h={pressed:!0,rightFlag:b,bottomFlag:g,currentTableEl:r[0],currentTrEl:s[0],firstTdEl:I,colEl:R,currentTdEl:this,currentTdLeft:c,currentTdRight:d,currentTdTop:f,currentTdBottom:p,startX:o.pageX,startWidth:H,startY:o.pageY,startHeight:n.height(),contenteditable:w},v&&(r.toggleClass("unselectable",!0),r.attr("unselectable","on")),q(n),o.stopPropagation()})),r.editingArea.on("mousemove",".note-editable",(function(t){if(!h.pressed)return!0;var o=e(this),n=h.currentTdLeft,r=h.currentTdTop;if(h.rightFlag){if(!(n+1<=t.pageX))return E(o,h.contenteditable),F(),!0;var l=h.firstTdEl;h.colEl&&(l=h.colEl);var a=h.startWidth+(t.pageX-h.startX);z("width",e(l),a)}else if(h.bottomFlag){if(!(r+1<=t.pageY))return E(o,h.contenteditable),F(),!0;l=h.currentTrEl;var i=h.startHeight+(t.pageY-h.startY);z("height",e(l),i)}})),r.editingArea.on("mousemove mousedown touchstart",".note-editable",(function(e){if(!h.pressed)return!0;e.preventDefault()})),r.editingArea.on("mouseup",".note-editable",(function(t){var n=e("table.unselectable");if(n.toggleClass("unselectable",!1),n.attr("unselectable","off"),!h.pressed)return!0;o.invoke("beforeCommand"),E(e(this),h.contenteditable),F(),o.invoke("afterCommand")}))}},l.initialize=function(){0==e("#input-spin-buton").length&&(this.$css=e("<style>").html("input::-webkit-outer-spin-button,input::-webkit-inner-spin-button {-webkit-appearance: none;margin: 0;} input[type=number] {-moz-appearance: textfield;}"),this.$css.attr("id","input-spin-buton"),e(document.head).append(this.$css))},l.destroy=function(){s.hideDialog(n),n.remove(),s.hideDialog(r),r.remove()}}}})})?n.apply(t,r):n)||(e.exports=l)}});