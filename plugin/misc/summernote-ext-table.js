!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/",o(o.s=15)}({0:function(e,t){e.exports=$},15:function(e,t,o){var n,r,a;function l(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}r=[o(0)],void 0===(a="function"==typeof(n=function(e){var t=function e(t,o,n,r){var a={colPos:0,rowPos:0},l=[],i=[],c=[];function s(e,t,o,n,r,a,i){var c={baseRow:o,baseCell:n,isRowSpan:r,isColSpan:a,isVirtual:i};l[e]||(l[e]=[]),l[e][t]=c}function d(e,t,o,n){return{baseCell:e.baseCell,action:t,virtualTable:{rowIndex:o,cellIndex:n}}}function u(e,t,o){if(!e[t])return o;if(!e[t][o])return o;for(var n=o;e[t][n];)if(n++,!e[t][n])return n}function b(e,t){var o=u(l,e.rowIndex,t.cellIndex),n=t.colSpan>1,r=t.rowSpan>1,i=e.rowIndex===a.rowPos&&t.cellIndex===a.colPos;s(e.rowIndex,o,e,t,r,n,!1);var c=t.attributes.rowSpan?parseInt(t.attributes.rowSpan.value,10):0;if(c>1)for(var d=1;d<c;d++){var b=e.rowIndex+d;p(b,o,t,i),s(b,o,e,t,!0,n,!0)}var f=t.attributes.colSpan?parseInt(t.attributes.colSpan.value,10):0;if(f>1)for(var g=1;g<f;g++){var v=u(l,e.rowIndex,o+g);p(e.rowIndex,v,t,i),s(e.rowIndex,v,e,t,r,!0,!0)}}function p(e,t,o,n){e===a.rowPos&&a.colPos>=o.cellIndex&&o.cellIndex<=t&&!n&&a.colPos++}function f(t){switch(o){case e.where.Column:if(t.isColSpan)return e.resultAction.SubtractSpanCount;break;case e.where.Row:if(!t.isVirtual&&t.isRowSpan)return e.resultAction.AddCell;if(t.isRowSpan)return e.resultAction.SubtractSpanCount}return e.resultAction.RemoveCell}function g(t){switch(o){case e.where.Column:if(t.isColSpan)return e.resultAction.SumSpanCount;if(t.isRowSpan&&t.isVirtual)return e.resultAction.Ignore;break;case e.where.Row:if(t.isRowSpan)return e.resultAction.SumSpanCount;if(t.isColSpan&&t.isVirtual)return e.resultAction.Ignore}return e.resultAction.AddCell}function v(e,t,o,n,r,a,l){var i={baseRow:o,baseCell:n,isRowSpan:r,isColSpan:a,isVirtual:l};c[e]||(c[e]=[]),c[e][t]=i}function m(e,t){var o=e.rowIndex,n=u(c,e.rowIndex,t.cellIndex),r=t.rowSpan>1,a=t.colSpan>1;v(o,n,e,t,r,a,!1);var l=t.rowSpan,i=t.colSpan;if(a)for(var s=1;s<i;s++)v(o,n+s,e,t,r,a,!0);if(r)for(var d=1;d<l;d++)if(v(o+d,n,e,t,r,a,!0),a)for(var b=1;b<i;b++)v(o+d,n+b,e,t,r,a,!0)}this.getActionList=function(){for(var t=o===e.where.Row?a.rowPos:-1,r=o===e.where.Column?a.colPos:-1,c=0,s=!0;s;){var u=t>=0?t:c,b=r>=0?r:c,p=l[u];if(!p)return s=!1,i;var v=p[b];if(!v)return s=!1,i;var m=e.resultAction.Ignore;switch(n){case e.requestAction.Add:m=g(v);break;case e.requestAction.Delete:m=f(v)}i.push(d(v,m,u,b)),c++}return i},this.getVirtualTable=function(){return l},this.getMatrixTable=function(){return c},this.getColCount=function(){for(var e=0,t=0;t<c.length;t++){var o=c[t];e<=o.length&&(e=o.length)}return e},t&&t.tagName&&("td"===t.tagName.toLowerCase()||"th"===t.tagName.toLowerCase())&&(a.colPos=t.cellIndex,t.parentElement&&t.parentElement.tagName&&"tr"===t.parentElement.tagName.toLowerCase()&&(a.rowPos=t.parentElement.rowIndex)),function(){for(var e=r.rows,t=0;t<e.length;t++)for(var o=e[t].cells,n=0;n<o.length;n++)b(e[t],o[n])}(),function(){for(var e=r.rows,t=0;t<e.length;t++)for(var o=e[t].cells,n=0;n<o.length;n++)m(e[t],o[n])}()};t.where={Row:0,Column:1},t.requestAction={Add:0,Delete:1},t.resultAction={Ignore:0,SubtractSpanCount:1,RemoveCell:2,AddCell:3,SumSpanCount:4},e.extend(!0,e.summernote.options,{jTable:{mergeMode:"drag"}}),e.extend(!0,e.summernote.lang,{"zh-TW":{jTable:{borderColor:"外框顏色",merge:{merge:"合併儲存格",colspan:"欄",rowspan:"列",split:"取消合併儲存格"},align:{top:"靠上對齊",middle:"置中對齊",bottom:"靠下對齊",baseline:"baseline"},info:{info:"table info",margin:"邊界"},apply:"套用",addDeleteRowCOl:"欄/列(插入/刪除)",areaReset:"清除格式",message:"<b>取消合併儲存格才可使用</br>"}},"en-US":{jTable:{borderColor:"Border color",merge:{merge:"cell merge",colspan:"colspan",rowspan:"rowspan",split:"cell split"},align:{top:"top",middle:"middle",bottom:"bottom",baseline:"baseline"},info:{info:"table info",margin:"margin"},apply:"apply",addDeleteRowCOl:"Row/Col(Add/Del)",areaReset:"area Reset",message:"<b>Available after unmerge<br/>current or surrounding cells</br>"}},"ko-KR":{jTable:{borderColor:"선색",merge:{merge:"셀 합치기",colspan:"가로",rowspan:"세로",split:"셀 나누기"},align:{top:"위쪽 정렬",middle:"가운데 정렬",bottom:"아래쪽 정렬",baseline:"기본 정렬"},info:{info:"테이블 정보",margin:"여백"},apply:"적용",addDeleteRowCOl:"행/열(추가/삭제)",areaReset:"넓이/높이 초기화",message:"<b>현재 또는 주위 셀<br/>병합 해제 후 사용 가능</b>"}}}),e.extend(!0,e.summernote,{plugins:{jTable:function(o){var n,r,a=this,i=e.summernote.dom,c=e.summernote.ui,s=o.modules,d=o.options,u=(o.layoutInfo.editable,d.langInfo),b=navigator.userAgent,p=/MSIE|Trident/i.test(b),f=/Edge\/\d+/.test(b),g=(!f&&/firefox/i.test(b),!f&&/firefox/i.test(b),/PhantomJS/i.test(b),!f&&/webkit/i.test(b),!f&&/chrome/i.test(b),!f&&/safari/i.test(b)&&/chrome/i.test(b),{pressed:!1,rightFlag:!1,bottomFlag:!1,currentTableEl:void 0,currentTrEl:void 0,firstTdEl:void 0,colEl:void 0,currentTdEl:void 0,currentTdLeft:void 0,currentTdRight:void 0,currentTdTop:void 0,currentTdBottom:void 0,startX:void 0,startWidth:void 0,startY:void 0,startHeight:void 0,contenteditable:!1}),v={pressed:!1,currentTableEl:void 0,currentTdEl:void 0,currentTdLeft:void 0,currentTdRight:void 0,currentTdTop:void 0,currentTdBottom:void 0,currentTdPosition:{row:void 0,col:void 0},width:void 0,height:void 0,top:void 0,left:void 0,effect:{row:{start:void 0,end:void 0},col:{start:void 0,end:void 0}}},m=[c.button({className:"btn-md",contents:c.icon(d.icons.rowAbove),tooltip:u.table.addRowAbove,container:d.container,click:o.createInvokeHandler("jTable.jAddRow","top")}),c.button({className:"btn-md",contents:c.icon(d.icons.rowBelow),tooltip:u.table.addRowBelow,container:d.container,click:o.createInvokeHandler("jTable.jAddRow","bottom")}),c.button({className:"btn-md",contents:c.icon(d.icons.colBefore),tooltip:u.table.addColLeft,container:d.container,click:o.createInvokeHandler("jTable.jAddCol","left")}),c.button({className:"btn-md",contents:c.icon(d.icons.colAfter),tooltip:u.table.addColRight,container:d.container,click:o.createInvokeHandler("jTable.jAddCol","right")})],h=[c.button({className:"btn-md",contents:c.icon(d.icons.rowRemove),tooltip:u.table.delRow,container:d.container,click:o.createInvokeHandler("jTable.jDeleteRow")}),c.button({className:"btn-md",contents:c.icon(d.icons.colRemove),tooltip:u.table.delCol,container:d.container,click:o.createInvokeHandler("jTable.jDeleteCol")})];a.recoverPopover=function(t){var o=e(t.target).closest("button"),n=o.closest(".dropdown-toggle"),r=s.editor.getLastRange.call(s.editor),a=i.ancestor(r.commonAncestor(),i.isCell);if(o.closest(".popover").length){var l=o.closest(".popover").css("left"),c=o.closest(".popover").css("top"),d=o.outerHeight();setTimeout(function(){s.tablePopover.update(a);var e=o.closest(".popover"),t=n.next(".dropdown-menu");e.css({left:l,top:c}),t.css({transform:"translate3d(0px, ".concat(d,"px, 0px)")})},0)}},o.memo("button.jAddDeleteRowCol",function(){return c.buttonGroup({className:"jtable-add-del-row-col jtable-display",children:[c.button({className:"dropdown-toggle",contents:c.dropdownButtonContents(c.icon(d.icons.rowAbove),d),tooltip:u.jTable.addDeleteRowCOl,container:d.container,data:{toggle:"dropdown"},click:function(o){var n=e(this).closest(".jtable-add-del-row-col"),r=n.find(".btn-md"),l=!1,c=s.editor.getLastRange.call(s.editor);if(c.isCollapsed()&&c.isOnCell()){var d=i.ancestor(c.commonAncestor(),i.isCell);if(!(l=d.rowSpan>1||d.colSpan>1)){for(var u=e(d).closest("table"),b=e(d).closest("tr"),p=b[0].rowIndex,f=new t(d,void 0,void 0,u[0]),g=f.getMatrixTable(),v=g[p],m=0,h=0;h<v.length;h++){var w=v[h];w.isVirtual||d!=w.baseCell||(m=h),(w.baseCell.colSpan>1||w.baseCell.rowSpan>1)&&(l=!0)}for(var C=0;C<g.length;C++){var w=g[C][m];(w.baseCell.colSpan>1||w.baseCell.rowSpan>1)&&(l=!0)}}}r.toggleClass("disabled",l),r.attr("disabled",l);var j=n.find(".jtable-add-row-col-button-group, .jtable-del-row-col-button-group"),T=n.find(".jtable-dropdown-message"),x=n.find(".jtable-add-del-row-col-dropdown");l?(j.hide(),T.show()):(j.show(),T.hide(),x.css("width","")),a.recoverPopover(o)}}),c.dropdown({className:"jtable-add-del-row-col-dropdown",children:[c.button({className:"jtable-dropdown-message",contents:u.jTable.message,container:d.container}),c.buttonGroup({className:"jtable-add-row-col-button-group",children:m}),c.buttonGroup({className:"jtable-del-row-col-button-group",children:h})]})]}).render()}),a.jAddRow=function(e){var t=s.editor.getLastRange.call(s.editor);if(t.isCollapsed()&&t.isOnCell()){a.beforeCommand();var o=i.ancestor(t.commonAncestor(),i.isCell);a.addRow(o,e),a.afterCommand()}},a.addRow=function(o,n){for(var r=e(o).closest("tr"),l=a.recoverAttributes(r),c=e("<tr"+l+"></tr>"),s=new t(o,t.where.Row,t.requestAction.Add,e(r).closest("table")[0]),d=s.getActionList(),u=0;u<d.length;u++){var b=d[u],p=a.recoverAttributes(b.baseCell);switch(b.action){case t.resultAction.AddCell:c.append("<td"+p+">"+i.blank+"</td>");break;case t.resultAction.SumSpanCount:if("top"===n){var f=b.baseCell.parent,g=(f?b.baseCell.closest("tr").rowIndex:0)<=r[0].rowIndex;if(g){var v=e("<div></div>").append(e("<td"+p+">"+i.blank+"</td>").removeAttr("rowspan")).html();c.append(v);break}}var m=parseInt(b.baseCell.rowSpan,10);m++,b.baseCell.setAttribute("rowSpan",m)}}if("top"===n)r.before(c);else{var h=o.rowSpan>1;if(h){var w=r[0].rowIndex+(o.rowSpan-2);return void e(e(r).parent().find("tr")[w]).after(e(c))}r.after(c)}},a.jAddCol=function(e){var t=s.editor.getLastRange.call(s.editor);if(t.isCollapsed()&&t.isOnCell()){a.beforeCommand();var o=i.ancestor(t.commonAncestor(),i.isCell);a.addCol(o,e),a.afterCommand()}},a.addCol=function(o,n){for(var r=e(o).closest("tr"),l=e(r).closest("table").find("colgroup").children("col"),c=r.children().index(e(o)),s=new t(o,t.where.Column,t.requestAction.Add,e(r).closest("table")[0]),d=s.getActionList(),u=0;u<d.length;u++){var b=d[u],p=a.recoverAttributes(b.baseCell);switch(b.action){case t.resultAction.AddCell:"right"===n?e(b.baseCell).after("<td"+p+">"+i.blank+"</td>"):e(b.baseCell).before("<td"+p+">"+i.blank+"</td>");break;case t.resultAction.SumSpanCount:var f=parseInt(b.baseCell.colSpan,10);f++,b.baseCell.setAttribute("colSpan",f)}}if(l.length){for(var g=0;g<l.length;g++){var v=l[g],m=v.span;for(v.span=1;m>1;)e(v).after(e(v).prop("outerHTML")),m-=1}var h=l[c],w=a.recoverAttributes(h),C=e("<col"+w+"/>");C.width(100),"right"===n?e(h).after(C[0]):e(h).before(C[0])}},a.jDeleteRow=function(){var o=s.editor.getLastRange.call(s.editor);if(o.isCollapsed()&&o.isOnCell()){a.beforeCommand();for(var n=i.ancestor(o.commonAncestor(),i.isCell),r=e(n).closest("tr"),l=r.children("td, th").index(e(n)),c=r[0].rowIndex,d=new t(n,t.where.Row,t.requestAction.Delete,e(r).closest("table")[0]),u=d.getActionList(),b=0;b<u.length;b++)if(u[b]){var p=u[b].baseCell,f=u[b].virtualTable,g=p.rowSpan&&p.rowSpan>1,v=g?parseInt(p.rowSpan,10):0;switch(u[b].action){case t.resultAction.Ignore:continue;case t.resultAction.AddCell:var m=r.next("tr")[0];if(!m)continue;var h=r[0].cells[l];g&&(v>2?(v--,m.insertBefore(h,m.cells[l]),m.cells[l].setAttribute("rowSpan",v),m.cells[l].innerHTML=""):2===v&&(m.insertBefore(h,m.cells[l]),m.cells[l].removeAttribute("rowSpan"),m.cells[l].innerHTML=""));continue;case t.resultAction.SubtractSpanCount:g&&(v>2?(v--,p.setAttribute("rowSpan",v),f.rowIndex!==c&&p.cellIndex===l&&(p.innerHTML="")):2===v&&(p.removeAttribute("rowSpan"),f.rowIndex!==c&&p.cellIndex===l&&(p.innerHTML="")));continue;case t.resultAction.RemoveCell:continue}}r.remove(),a.afterCommand()}},a.jDeleteCol=function(){var o=s.editor.getLastRange.call(s.editor);if(o.isCollapsed()&&o.isOnCell()){a.beforeCommand();for(var n=i.ancestor(o.commonAncestor(),i.isCell),r=e(n).closest("tr"),l=r.children("td, th").index(e(n)),c=e(r).closest("table").find("colgroup").children("col"),d=r.children().index(e(n)),u=new t(n,t.where.Column,t.requestAction.Delete,e(r).closest("table")[0]),b=u.getActionList(),p=0;p<b.length;p++)if(b[p])switch(b[p].action){case t.resultAction.Ignore:continue;case t.resultAction.SubtractSpanCount:var f=b[p].baseCell,g=f.colSpan&&f.colSpan>1;if(g){var v=f.colSpan?parseInt(f.colSpan,10):0;v>2?(v--,f.setAttribute("colSpan",v),f.cellIndex===l&&(f.innerHTML="")):2===v&&(f.removeAttribute("colSpan"),f.cellIndex===l&&(f.innerHTML=""))}continue;case t.resultAction.RemoveCell:i.remove(b[p].baseCell,!0);continue}if(c.length){var m=c[d];e(m).remove()}a.afterCommand()}},a.recoverAttributes=function(e){var t="";if(!e)return t;for(var o=e.attributes||[],n=0;n<o.length;n++)"id"!==o[n].name.toLowerCase()&&("span"===o[n].name.toLowerCase()&&"col"==e.tagName.toLowerCase()||o[n].specified&&(t+=" "+o[n].name+"='"+o[n].value+"'"));return t},a.beforeCommand=function(){s.editor.beforeCommand.call(s.editor)},a.afterCommand=function(){s.editor.afterCommand.call(s.editor)},o.memo("button.jTable",function(){return c.buttonGroup([c.button({className:"dropdown-toggle",contents:c.dropdownButtonContents(c.icon(d.icons.table),d),tooltip:u.table.table,container:d.container,data:{toggle:"dropdown"},click:function(e){a.recoverPopover(e)}}),c.dropdown({title:u.table.table,className:"note-table",items:['<div class="note-dimension-picker">','<div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div>','<div class="note-dimension-picker-highlighted"></div>','<div class="note-dimension-picker-unhighlighted"></div>',"</div>",'<div class="note-dimension-display">1 x 1</div>'].join("")})],{callback:function(e){var t=e.find(".note-dimension-picker-mousecatcher");t.css({width:d.insertTableMaxSize.col+"em",height:d.insertTableMaxSize.row+"em"}).mousedown(o.createInvokeHandler("jTable.insertTable")).on("mousemove",s.buttons.tableMoveHandler.bind(o))}}).render()}),a.insertTable=function(e){a.beforeCommand();var t=e.split("x"),o=s.editor.getLastRange().deleteContents(),n=a.createTable(t[0],t[1],d);o.insertNode(n),a.afterCommand()},a.createTable=function(t,o,n){for(var r,a,l=[],c=[],s=0;s<t;s++)c.push("<td>"+i.blank+"</td>"),l.push('<col style="width: 100px;"/>');r="<colgroup>"+l.join("")+"</colgroup>",a=c.join("");for(var d,u=[],b=0;b<o;b++)u.push("<tr>"+a+"</tr>");d=u.join("");var p=e('<table class="jtable-expanded" style="width: auto !important;">'+r+d+"</table>");return n&&n.tableClassName&&p.addClass(n.tableClassName),p[0]},o.memo("button.jBorderColor",function(){return a.colorPalette("note-color-table-border",u.jTable.borderColor,a.jBorderColor)}),a.jBorderColor=function(t){a.beforeCommand();var o=v.currentTdEl;if(!o)return a.afterCommand();var n=e(o);n.closest("table").find("td, th").css("border","1px solid "+t),a.afterCommand()},o.memo("button.jBackcolor",function(){return a.colorPalette("note-color-back",u.color.background,a.color)}),a.color=function(o){a.beforeCommand();var n=v.currentTdEl;if(!n)return a.afterCommand();for(var r=e(n),l=r.closest("table"),i=new t(n,void 0,void 0,l[0]),c=i.getMatrixTable(),s=v.effect.row,d=v.effect.col,u=s.start;u<=s.end;u++)for(var b=d.start;b<=d.end;b++){var p=c[u][b];e(p.baseCell).css("background-color",o)}a.afterCommand()},a.colorPalette=function(t,o,n){return c.buttonGroup({className:"note-color jtable-display "+t,children:[c.button({className:"note-current-color-button note-table-color",contents:c.icon(d.icons.font+" note-recent-color"),tooltip:o,container:d.container,click:function(t){var o=e(t.currentTarget),r=o.attr("data-backColor");n(r)},callback:function(e){var o=e.find(".note-recent-color");o.css("background-color","note-color-table-border"==t?"#000000":d.colorButton.backColor),e.attr("data-backColor","note-color-table-border"==t?"#000000":d.colorButton.backColor),o.css("color","transparent")}}),c.button({className:"dropdown-toggle",contents:c.dropdownButtonContents("",d),tooltip:u.color.more,container:d.container,data:{toggle:"dropdown"},click:function(e){a.recoverPopover(e)}}),c.dropdown({items:['<div class="note-palette">','<div class="note-palette-title">'+o+"</div>","<div>",'<button type="button" class="note-color-reset btn btn-light" data-event="backColor" data-value="inherit">',u.color.transparent,"</button>","</div>",'<div class="note-holder" data-event="backColor"/>',"<div>"].join(""),callback:function(t){t.find(".note-holder").each(function(t,o){var n=e(o);n.append(c.palette(l({colors:d.colors,colorsName:d.colorsName,eventName:n.data("event"),container:d.container,tooltip:d.tooltip},"container",d.container)).render())});var o=[["#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"]];t.find(".note-holder-custom").each(function(t,n){var r=e(n);r.append(c.palette(l({colors:o,colorsName:o,eventName:r.data("event"),container:d.container,tooltip:d.tooltip},"container",d.container)).render())}),t.find("input[type=color]").each(function(o,n){e(n).change(function(){var o=t.find("#"+e(this).data("event")).find(".note-color-btn").first(),n=this.value.toUpperCase();o.css("background-color",n).attr("aria-label",n).attr("data-value",n).attr("data-original-title",n),o.click()})})},click:function(t){var o=e(this).closest(".note-popover").find(".note-dropdown-menu"),r=e(t.target),a=r.data("event"),l=r.attr("data-value");if("openPalette"===a){var i=o.find("#"+l),c=e(o.find("#"+i.data("event")).find(".note-color-row")[0]),s=c.find(".note-color-btn").last().detach(),d=i.val();s.css("background-color",d).attr("aria-label",d).attr("data-value",d).attr("data-original-title",d),c.prepend(s),i.click()}else{var u="backColor"===a?"background-color":"color",b=r.closest(".note-color").find(".note-recent-color"),p=r.closest(".note-color").find(".note-current-color-button");b.css(u,l),p.attr("data-"+a,l),n(l)}}})]}).render()},a.setCellHorizontalAlign=function(o){a.beforeCommand();for(var n=v.currentTdEl,r=e(n),l=r.closest("table"),i=new t(n,void 0,void 0,l[0]),c=i.getMatrixTable(),s=v.effect.row,d=v.effect.col,u=s.start;u<=s.end;u++)for(var b=d.start;b<=d.end;b++){var p=c[u][b];e(p.baseCell).css("text-align",o)}a.afterCommand()},a.setCellVerticalAlign=function(o){a.beforeCommand();for(var n=v.currentTdEl,r=e(n),l=r.closest("table"),i=new t(n,void 0,void 0,l[0]),c=i.getMatrixTable(),s=v.effect.row,d=v.effect.col,u=s.start;u<=s.end;u++)for(var b=d.start;b<=d.end;b++){var p=c[u][b];e(p.baseCell).css("vertical-align",o)}a.afterCommand()};var w=[c.button({contents:c.icon(d.icons.alignLeft),tooltip:u.paragraph.left,container:d.container,click:o.createInvokeHandler("jTable.setCellHorizontalAlign","left")}),c.button({contents:c.icon(d.icons.alignCenter),tooltip:u.paragraph.center,container:d.container,click:o.createInvokeHandler("jTable.setCellHorizontalAlign","center")}),c.button({contents:c.icon(d.icons.alignRight),tooltip:u.paragraph.right,container:d.container,click:o.createInvokeHandler("jTable.setCellHorizontalAlign","right")}),c.button({contents:c.icon(d.icons.alignJustify),tooltip:u.paragraph.justify,container:d.container,click:o.createInvokeHandler("jTable.setCellHorizontalAlign","justify")})],C=[c.button({className:"jtable-vertical-align-btn-top",contents:c.icon(d.icons.alignJustify),tooltip:u.jTable.align.top,container:d.container,click:o.createInvokeHandler("jTable.setCellVerticalAlign","top")}),c.button({className:"jtable-vertical-align-btn-middle",contents:c.icon(d.icons.alignJustify),tooltip:u.jTable.align.middle,container:d.container,click:o.createInvokeHandler("jTable.setCellVerticalAlign","middle")}),c.button({className:"jtable-vertical-align-btn-bottom",contents:c.icon(d.icons.alignJustify),tooltip:u.jTable.align.bottom,container:d.container,click:o.createInvokeHandler("jTable.setCellVerticalAlign","bottom")}),c.button({className:"jtable-vertical-align-btn-baseline",contents:c.icon(d.icons.alignJustify),tooltip:u.jTable.align.baseline,container:d.container,click:o.createInvokeHandler("jTable.setCellVerticalAlign","baseline")})];o.memo("button.jAlign",function(){return c.buttonGroup([c.button({className:"dropdown-toggle jtable-display",contents:c.dropdownButtonContents(c.icon(d.icons.alignLeft),d),tooltip:u.paragraph.paragraph,container:d.container,data:{toggle:"dropdown"},click:function(e){a.recoverPopover(e)}}),c.dropdown({className:"jtable-align-dropdown",children:[c.buttonGroup({className:"jtable-horizontal-align-button-group",children:w}),c.buttonGroup({className:"jtable-vertical-align-button-group",children:C})]})],{callback:function(e){}}).render()});var j=['<div class="form-group">','<label for="jtable-cell-merge-col'+d.id+'" class="note-form-label jtable-merge-label">'+u.jTable.merge.colspan+"</label>",'<input id="jtable-cell-merge-col'+d.id+'" class="note-input jtable-merge-input jtable-merge-col-input" type="number" name="col"/>','<span class="jtable-merge-hint-span">(min : <span class="jtable-merge-hint-col-min">1</span> / max : <span class="jtable-merge-hint-col-max">1</span>)</span>',"</div>",'<div class="form-group jtable-merge-row-info-div">','<label for="jtable-cell-merge-row'+d.id+'" class="note-form-label jtable-merge-label">'+u.jTable.merge.rowspan+"</label>",'<input id="jtable-cell-merge-row'+d.id+'" class="note-input jtable-merge-input jtable-merge-row-input" type="number" name="row"/>','<span class="jtable-merge-hint-span">(min : <span class="jtable-merge-hint-row-min">1</span> / max : <span class="jtable-merge-hint-row-max">1</span>)</span>',"</div>"].join(""),T='<input type="button" href="#" class="btn btn-primary note-btn note-btn-primary jtable-merge-btn" value="'+u.jTable.merge.merge+'" disabled>';(n=c.dialog({title:u.jTable.merge.merge,fade:d.dialogsFade,body:j,footer:T}).render().appendTo(d.container)).find(".note-modal-content").width(340),n.find(".note-modal-body").css("padding","20px 20px 10px 20px");var x=[c.button({contents:c.icon("note-icon-table-merge"),tooltip:u.jTable.merge.merge,container:d.container,click:o.createInvokeHandler("jTable.cellMerge")}),c.button({className:"note-btn-jtable-cell-split",contents:c.icon("note-icon-table-cell-split"),tooltip:u.jTable.merge.split,container:d.container,click:o.createInvokeHandler("jTable.cellSplit")})];function A(t,o){a.beforeCommand();var n=e(t),r=o.merge.col-o.current.col,l=o.merge.row-o.current.row;n.prop("colspan",o.merge.col);for(var i=0;i<r;i++)e(o.effect.col[i]).remove();n.prop("rowspan",o.merge.row);for(var i=0;i<l;i++){var c=o.effect.row[i];if(r>0)for(var s=0;s<r;s++)e(c).next().remove();e(c).remove()}var d=n.closest("table"),u=d.children("tr");u.length||(u=d.children("tbody").children("tr"));for(var i=0;i<u.length;i++){var b=e(u[i]),p=b.find("td, th");p.length||b.remove()}a.afterCommand()}function k(o){for(var n=e(o),r=n.closest("table"),a=n.closest("tr"),l=parseInt(o.colSpan,10),i=parseInt(o.rowSpan,10),c=l-1,s=a[0].rowIndex,d=s+i-1,u=new t(o,void 0,void 0,r[0]),b=u.getMatrixTable(),p=(u.getColCount(),!1),f=[],g=s;g<=d;g++){for(var v=b[g],m=0;m<v.length;m++){if(p&&o!=v[m].baseCell&&!v[m].isVirtual){if(f.push(v[m].baseCell),g==s)for(var h=0;h<c;h++)e(v[m].baseCell).before(e("<td/>"));else for(var h=0;h<l;h++)e(v[m].baseCell).before(e("<td/>"));break}if(o==v[m].baseCell&&(p=!0),p&&m==v.length-1){var w=v[m].baseCell;if(g==s)for(var h=0;h<c;h++)e(w).after(e("<td/>"));else{var C=r.children("tr");C.length||(C=C.children("tbody").children("tr")),w=e(C[g]).children().last();for(var h=0;h<l;h++)e(w).after(e("<td/>"))}}}p=!1}n.prop("colspan",1),n.prop("rowspan",1)}function S(o){var n=e(o).closest("table"),r=e(o).closest("tr"),a=r[0].rowIndex,l=new t(o,void 0,void 0,n[0]),i=l.getMatrixTable(),c=i[a],s=0,d=!1,u=1,b=[];if(o.rowSpan>1)u=o.colSpan;else for(var p=0;p<c.length;p++){var f=c[p];d&&(b.push(f.baseCell),u++),d||o!=f.baseCell?d&&(f.baseCell.colSpan>1||f.baseCell.rowSpan>1)&&(u--,b.pop(),d=!1):(s=p,d=!0)}d=!1;var g=1,v=[];if(o.colSpan>1)g=o.rowSpan;else for(var m=0;m<i.length;m++){var f=i[m][s];d&&(v.push(f.baseCell),g++),d||o!=f.baseCell?d&&(f.baseCell.colSpan>1||f.baseCell.rowSpan>1)&&(g--,v.pop(),d=!1):d=!0}return{trIndex:a,tdIndex:s,current:{col:o.colSpan,row:o.rowSpan},max:{col:u,row:g},effect:{col:b,row:v}}}o.memo("button.jMerge",function(){return c.buttonGroup({className:"jtable-display",children:[c.button({className:"dropdown-toggle jtable-cell-split-dropdown-toggle",contents:c.dropdownButtonContents(c.icon("note-icon-table-merge"),d),tooltip:u.jTable.merge.merge,container:d.container,data:{toggle:"dropdown"},click:function(t){var o=e(this).parent(),n=o.find(".note-btn-jtable-cell-split"),r=!1,l=s.editor.getLastRange.call(s.editor);if(l.isCollapsed()&&l.isOnCell()){var c=i.ancestor(l.commonAncestor(),i.isCell);r=c.rowSpan>1||c.colSpan>1}n.toggleClass("disabled",!r),n.attr("disabled",!r),a.recoverPopover(t)}}),c.dropdown({className:"jtable-cell-split-dropdown",children:[c.buttonGroup({className:"jtable-cell-split-button-group",children:x})]})]}).render()}),a.cellMerge=function(){"drag"==d.jTable.mergeMode?a.dragCellMerge():a.mergeDialogShow()},a.dragCellMerge=function(){var o=v.currentTdEl,n=e(o),r=n.closest("table"),a=new t(o,void 0,void 0,r[0]),l=a.getMatrixTable(),i=v.effect.row,c=v.effect.col;if(i.start==i.end&&c.start==c.end)return H(n),!0;for(var s=i.start;s<=i.end;s++)for(var d=c.start;d<=c.end;d++){var u=l[s][d];k(u.baseCell)}var b=S(o),p={trIndex:b.trIndex,colIndex:b.colIndex,current:{col:b.current.col,row:b.current.row},merge:{col:parseInt(c.end-c.start+1,10),row:parseInt(i.end-i.start+1,10)},effect:{col:b.effect.col,row:b.effect.row}},f=l[i.start][c.start];A(f.baseCell,p),H(n)},a.mergeDialogShow=function(){var t=s.editor.getLastRange.call(s.editor);if(t.isCollapsed()&&t.isOnCell()){var r=i.ancestor(t.commonAncestor(),i.isCell),a=S(r);s.tablePopover.hide(),o.invoke("editor.saveRange"),function(t){return e.Deferred(function(e){var r=n.find(".jtable-merge-input"),a=n.find(".jtable-merge-col-input"),l=n.find(".jtable-merge-hint-col-min"),i=n.find(".jtable-merge-hint-col-max"),s=n.find(".jtable-merge-row-input"),d=n.find(".jtable-merge-hint-row-min"),u=n.find(".jtable-merge-hint-row-max"),b=n.find(".jtable-merge-btn");a.val(t.current.col),l.text(t.current.col),i.text(t.max.col),s.val(t.current.row),d.text(t.current.row),u.text(t.max.row),c.onDialogShown(n,function(){o.triggerEvent("dialog.shown"),r.on("input paste propertychange",function(){var e=!1,o=parseInt(a.val(),10),n=parseInt(s.val(),10);o==t.current.col&&n==t.current.row?e=!1:o>=t.current.col&&o<=t.max.col&&n>=t.current.row&&n<=t.max.row&&(e=!0),c.toggleBtn(b,e)}),b.click(function(o){o.preventDefault(),e.resolve({trIndex:t.trIndex,colIndex:t.colIndex,current:{col:t.current.col,row:t.current.row},merge:{col:parseInt(a.val(),10),row:parseInt(s.val(),10)},effect:{col:t.effect.col,row:t.effect.row}})})}),c.onDialogHidden(n,function(){r.off(),b.off(),c.toggleBtn(b,!1),"pending"===e.state()&&e.reject()}),c.showDialog(n)})}(a).then(function(e){c.hideDialog(n),o.invoke("editor.restoreRange");var r=i.ancestor(t.commonAncestor(),i.isCell);A(r,e)}).fail(function(){o.invoke("editor.restoreRange")})}},a.cellSplit=function(){var e=s.editor.getLastRange.call(s.editor);if(e.isCollapsed()&&e.isOnCell()){a.beforeCommand();var t=i.ancestor(e.commonAncestor(),i.isCell);k(t),a.afterCommand()}};var I=['<div class="form-group form-group-jtable-table-info-margin">','<div class="jtable-table-info-margin-top-bottom"><input type="number" value="0" class="jtable-table-info-margin-input jtable-table-info-margin-input-top"><span>px</span></div>','<div class="jtable-table-info-margin-middle">','<div class="jtable-table-info-margin-left"><input type="number" value="0" class="jtable-table-info-margin-input jtable-table-info-margin-input-left"><span>px</span></div>','<div class="jtable-table-info-margin-center"><b>Table</b><br><span class="jtable-table-info-width">0</span> X <span class="jtable-table-info-height">0</span></div>','<div class="jtable-table-info-margin-right"><input type="number" value="0" class="jtable-table-info-margin-input jtable-table-info-margin-input-right"><span>px</span></div>',"</div>",'<div class="jtable-table-info-margin-top-bottom"><input type="number" value="0" class="jtable-table-info-margin-input jtable-table-info-margin-input-bottom"><span>px</span></div>',"</div>"].join(""),y='<input type="button" href="#" class="btn btn-primary note-btn note-btn-primary jtable-apply-btn" value="'+u.jTable.apply+'" >';function R(e,t,o){switch(e){case"width":t.width(o);break;case"height":t.children().height(o)}}function F(e,t){e.closest(".note-editing-area").css("cursor","auto"),e.closest(".note-editable").prop("contenteditable",t)}function N(){g={pressed:!1,rightFlag:!1,bottomFlag:!1,currentTableEl:void 0,firstTdEl:void 0,colEl:void 0,currentTdEl:void 0,currentTdLeft:void 0,currentTdRight:void 0,currentTdTop:void 0,currentTdBottom:void 0,startX:void 0,startWidth:void 0,startY:void 0,startHeight:void 0,contenteditable:!1}}function H(e){v={pressed:!1,currentTableEl:void 0,currentTdEl:void 0,currentTdLeft:void 0,currentTdRight:void 0,currentTdTop:void 0,currentTdBottom:void 0,currentTdPosition:{row:void 0,col:void 0},width:void 0,height:void 0,top:void 0,left:void 0,effect:{row:{start:void 0,end:void 0},col:{start:void 0,end:void 0}}};var t=e.closest(".note-editing-area").find(".jtable-block");t.hide()}function E(e,o){for(var n=new t(e,void 0,void 0,o),r=n.getMatrixTable(),a=0;a<r.length;a++)for(var l=r[a],i=0;i<l.length;i++){var c=r[a][i];if(c.baseCell==e)return{row:a,col:i}}}(r=c.dialog({title:u.table.table+" "+u.jTable.info.margin,fade:d.dialogsFade,body:I,footer:y}).render().appendTo(d.container)).find(".note-modal-body").css("padding","20px 20px 10px 20px"),o.memo("button.jTableInfo",function(){return c.button({className:"jtable-display",contents:c.icon("note-icon-table-margin"),tooltip:u.table.table+" "+u.jTable.info.margin,container:d.container,click:o.createInvokeHandler("jTable.tableInfoDialogShow")}).render()}),a.tableInfoDialogShow=function(){var t=s.editor.getLastRange.call(s.editor);if(t.isCollapsed()&&t.isOnCell()){var a=i.ancestor(t.commonAncestor(),i.isCell),l=e(a).closest("table");s.tablePopover.hide(),function(t){return e.Deferred(function(e){var a=r.find(".jtable-apply-btn"),l=r.find(".jtable-table-info-margin-input"),i=r.find(".jtable-table-info-margin-input-top"),s=r.find(".jtable-table-info-margin-input-left"),d=r.find(".jtable-table-info-margin-input-right"),u=r.find(".jtable-table-info-margin-input-bottom"),b=r.find(".jtable-table-info-width"),p=r.find(".jtable-table-info-height");i.val(parseInt(t.css("margin-top"),10)),s.val(parseInt(t.css("margin-left"),10)),d.val(parseInt(t.css("margin-right"),10)),u.val(parseInt(t.css("margin-bottom"),10)),b.text(t.width()),p.text(t.height()),c.onDialogShown(r,function(){o.triggerEvent("dialog.shown"),l.on("input paste propertychange",function(){var e=!0,t=parseInt(i.val(),10),o=parseInt(s.val(),10),n=parseInt(d.val(),10),r=parseInt(u.val(),10);(t<0||o<0||n<0||r<0)&&(e=!1),c.toggleBtn(a,e)}),a.click(function(t){o.invoke("beforeCommand"),t.preventDefault(),e.resolve([parseInt(i.val(),10)+"px",parseInt(d.val(),10)+"px",parseInt(u.val(),10)+"px",parseInt(s.val(),10)+"px"]),o.invoke("afterCommand")})}),c.onDialogHidden(n,function(){l.off(),a.off(),c.toggleBtn(a,!1),"pending"===e.state()&&e.reject()}),c.showDialog(r)})}(l).then(function(e){c.hideDialog(r),o.invoke("editor.restoreRange"),l.css("margin",e.join(" "))}).fail(function(){o.invoke("editor.restoreRange")})}},o.memo("button.jWidthHeightReset",function(){return c.button({className:"jtable-display",contents:c.icon("note-icon-table-width-height-reset"),tooltip:u.table.table+" "+u.jTable.areaReset,container:d.container,click:o.createInvokeHandler("jTable.jWidthHeightReset")}).render()}),a.jWidthHeightReset=function(){var o=s.editor.getLastRange.call(s.editor);if(o.isCollapsed()&&o.isOnCell()){a.beforeCommand();var n=i.ancestor(o.commonAncestor(),i.isCell),r=e(n).closest("table");r.removeAttr("width"),r.removeAttr("height"),r.css("width","auto"),r.css("height","");var l=r.find("tr, td, th");l.removeAttr("width"),l.removeAttr("height"),l.css("width",""),l.css("height","");var c=new t(n,void 0,void 0,r[0]),d=c.getColCount();r.find("colgroup:first").remove();for(var u=e("<colgroup/>"),b=0;b<d;b++)u.append('<col style="width: 100px;"/>');r.prepend(u),a.afterCommand()}},a.expandColgroup=function(e){for(var t="",o=e.closest("table"),n=0;n<e.length;n++){var r=e[n],a=r.span;r.removeAttribute("width");for(var l=r.offsetWidth,i=r.offsetHeight,c='style="width:'.concat(l,"px; height:").concat(i,'px"');a>0;)t=t.concat("<col ".concat(c," />")),a-=1}e.closest("colgroup").html(t),o.removeAttr("width"),o.css("width",""),o.css("table-layout","fixed")},a.events={"summernote.init":function(n,r){r.editingArea.append('<div class="jtable-block"><div/>'),r.toolbar.find(".jtable-display").hide(),r.editingArea.on("keydown",function(o){if((o.metaKey||o.ctrlKey)&&"c"===String.fromCharCode(o.which).toLowerCase()){var n=e(o.target),r=n.closest(".note-editing-area").find(".jtable-block");if("block"==r.css("display")){var a=v.currentTableEl,l=v.effect,i=new t(this,void 0,void 0,a),c=i.getVirtualTable(),s=document.createElement("table");s.className=a.className,e(s).toggleClass("jtable-expanded",!1);for(var d=document.createElement("colgroup"),u=e(a).find("colgroup col"),b=0;b<c[0].length;b++){var p=c[0][b],f=document.createElement("col"),g=u[b].style.width?u[b].style.width:p.baseCell.style.width;f.style.width=g,d.appendChild(f)}s.appendChild(d);for(var m=l.row.start;m<=l.row.end;m++){for(var h=c[m],w=document.createElement("tr"),C=l.col.start,j=0;C<=l.col.end;C++,j++){var T=h[C];T.isVirtual||(w.style.width=d.childNodes[j].style.width,e(w).append(T.baseCell.outerHTML))}s.appendChild(w)}n.closest(".note-editor").after(s);var x=e.summernote.range.createFromNode(s);x.select(),document.execCommand("copy"),e(s).remove()}}}),r.editingArea.on("paste",".note-editable",function(o){var n=e(o.target).closest(".note-editable");setTimeout(function(){for(var o=n.find("table").not(".jtable-expanded"),r=0;r<o.length;r++){var l=e(o[r]);if(l.children("colgroup").children("col").length){var i=l.children("colgroup").children("col");a.expandColgroup(i),l.toggleClass("jtable-expanded",!0)}else{for(var c=new t(this,void 0,void 0,o[r]),s=c.getVirtualTable(),i=document.createElement("colgroup"),d=0;d<s[0].length;d++){var u=s[0][d],b=document.createElement("col"),p=u.baseCell.style.width;if(u.baseCell.colSpan>1){var f=p.match(/([0-9]*)([a-z]*$)/);p=f[1]/u.baseCell.colSpan+f[2]}b.style.width=p,i.appendChild(b)}l.prepend(i)}}},1)}),r.editingArea.on("paste",".note-editable",function(o){setTimeout(function(){var n=e(o.target).closest(".note-editable"),r=n.closest(".note-editing-area").find(".jtable-block");if(!v.currentTableEl||!r[0]||"none"==r[0].style.display)return!0;var l=n.find("table.jtable-paste");if(l.length||(l=e(o.target).find("table")),!l.length)return!0;l.remove();var i=l.find("tr, td, th"),c=new t(i,void 0,void 0,l[0]),s=c.getMatrixTable(),d=s.length,u=s[0].length,b=v.currentTableEl,p=v.currentTdEl,f=v.effect.row,g=v.effect.col,m=f.end-f.start+1,h=g.end-g.start+1,w=0;if((w=d==m&&u==h?1:u>h||d>m?2:0)>0){if(2==w){for(var C=h;C<u;C++)a.addCol(p,"right");h=u;for(var j=m;j<d;j++)a.addRow(p,"bottom");m=d}for(var T=new t(p,void 0,void 0,b),x=T.getMatrixTable(),A=0;A<m;A++)for(var k=x[A+f.start],S=s[A].filter(function(e){return!e.isVirtual}),I=0;I<h;I++){var y=k[I+g.start];y&&S[I]&&(y.baseCell.innerText=S[I].baseCell.innerText)}}else{for(var R=[],F=0,N=0;N<s.length;N++)for(var H=s[N],E=0;E<H.length;E++){var L=H[E];R.push(L)}for(var P=0;P<m;P++)for(var M=b.rows[P+f.start],D=0;D<h;D++,F++){var y=M.cells[D+g.start];if(!R[F])break;y.innerText=R[F].baseCell.innerText}}r.hide()},1)}),r.editingArea.on("click",function(t){var o=e(t.target).closest(".note-editor").find(".note-toolbar .jtable-display"),n=e(t.target).closest(".note-editable").next(".jtable-block");"none"==n.css("display")&&o.hide()}),r.editingArea.on("click",".note-editable table",function(t){var o=e(t.target).closest("td");o.length||(o=e(t.target).closest("th")),o.length&&s.tablePopover.update(o[0]);var n=e(t.target).closest(".note-editor").find(".note-toolbar .jtable-display");n.show(),t.stopPropagation()}),r.editingArea.on("mouseleave",".note-editable tr",function(t){if(v.pressed)return!0;if(g.pressed)return!0;var o=e(this),n=o.closest(".note-editing-area").css("cursor");"row-resize"!=n&&"col-resize"!=n||o.closest(".note-editing-area").css("cursor","auto")}),r.editingArea.on("mousemove",".note-editable td,th",function(t){if(v.pressed)return!0;if(g.pressed)return!0;var o=e(this),n=(o.closest("table"),o.closest("tr")),r=o.offset().left,a=o.outerWidth(),l=r+a,i=n.offset().top,c=o.outerHeight(),s=i+c,d=!1;l-5<=t.pageX&&(d=!0);var u,b=!1;s-5<=t.pageY&&(b=!0),u=d?"col-resize":b?"row-resize":"auto",o.closest(".note-editing-area").css("cursor",u)}),r.editingArea.on("mousedown","td",function(t){if(v.pressed)return!0;var o=e(this);if(H(o),g.pressed)return!0;var n=o.closest("table"),r=o.offset().top,a=o.offset().left,l=o.outerWidth(),i=o.outerHeight(),c=a+l,s=r+i,d=E(this,n[0]);v={pressed:!0,currentTableEl:n[0],currentTdEl:this,currentTdLeft:a,currentTdRight:c,currentTdTop:r,currentTdBottom:s,currentTdPosition:{row:d.row,col:d.col},width:c,height:s,top:r,left:a,effect:{row:{start:d.row,end:d.row},col:{start:d.col,end:d.col}}},t.stopPropagation()}),r.editingArea.on("mousemove",".note-editable",function(t){if(!v.pressed)return!0;s.tablePopover.hide();var o=e(t.target).closest("td");o.length||(o=e(t.target).closest("th"));var n=o.closest(".note-editing-area").find(".jtable-block");if(o.length){var r=o.closest("table"),a=o.offset().top,l=o.offset().left,i=o.outerWidth(),c=o.outerHeight(),d=l+i,u=a+c,b=E(o[0],r[0]),p=v.effect.col,f=v.effect.row;v.currentTdLeft>=l?(v.left=l,v.width=v.currentTdRight-l,p.end=v.currentTdPosition.col,p.start=b.col):(v.width=d-v.left,p.end=b.col),v.currentTdTop>=a?(v.top=a,v.height=v.currentTdBottom-a,f.end=v.currentTdPosition.row,f.start=b.row):(v.height=u-v.top,f.end=b.row),n.show(),n.offset({left:v.left,top:v.top}),n.css({width:v.width,height:v.height})}}),r.editingArea.on("mousedown",".note-editable",function(t){var o=e(t.target).closest(".note-editable").next(".jtable-block");o.hide()}),r.editingArea.on("mousemove mousedown touchstart",".note-editable",function(e){if(!v.pressed)return!0}),r.editingArea.on("mouseup",".note-editable",function(t){if(p){var o=e("table.unselectable");o.toggleClass("unselectable",!1),o.attr("unselectable","off")}if(!v.pressed)return!0;v.pressed=!1;var n=e(t.target).closest("td");n.length||(n=e(t.target).closest("th")),n.length&&s.tablePopover.update(n[0])}),r.editingArea.on("mousedown","td",function(o){var n=e(this),r=n.closest("table"),l=n.closest("tr"),i=n.offset().left,c=n.outerWidth(),d=i+c,u=l.offset().top,b=n.outerHeight(),f=u+b,v=!1;d-5<=o.pageX&&(v=!0);var m=!1;f-5<=o.pageY&&(m=!0);var h,w=n.closest(".note-editable").prop("contenteditable");if(!v&&!m)return F(n,w),void N();s.tablePopover.hide(),h=v?"col-resize":"row-resize",n.closest(".note-editing-area").css("cursor",h),n.closest(".note-editable").removeAttr("contenteditable");var C=r.children("colgroup").children("col");a.expandColgroup(C);for(var j=r.find("td"),T=0;T<j.length;T++){var x=j[T];x.width&&(x.width=""),x.style.width&&(x.style.width="")}for(var A=new t(this,void 0,void 0,r[0]),k=A.getVirtualTable(),S=l[0].rowIndex,I=this.colSpan>1,y=k[S],R=0;R<y.length;R++){var E=y[R];if(this==E.baseCell)break}I&&(R+=this.colSpan-1);var L=k[0][R].baseCell,P=r.find("colgroup:first col")[R],M=n.width();P&&(M=e(P).width()),g={pressed:!0,rightFlag:v,bottomFlag:m,currentTableEl:r[0],currentTrEl:l[0],firstTdEl:L,colEl:P,currentTdEl:this,currentTdLeft:i,currentTdRight:d,currentTdTop:u,currentTdBottom:f,startX:o.pageX,startWidth:M,startY:o.pageY,startHeight:n.height(),contenteditable:w},p&&(r.toggleClass("unselectable",!0),r.attr("unselectable","on")),H(n),o.stopPropagation()}),r.editingArea.on("mousemove",".note-editable",function(t){if(!g.pressed)return!0;var o=e(this),n=g.currentTdLeft,r=g.currentTdTop;if(g.rightFlag){if(!(n+1<=t.pageX))return F(o,g.contenteditable),N(),!0;var a=g.firstTdEl;g.colEl&&(a=g.colEl);var l=g.startWidth+(t.pageX-g.startX);R("width",e(a),l)}else if(g.bottomFlag){if(!(r+1<=t.pageY))return F(o,g.contenteditable),N(),!0;var a=g.currentTrEl,i=g.startHeight+(t.pageY-g.startY);R("height",e(a),i)}}),r.editingArea.on("mousemove mousedown touchstart",".note-editable",function(e){if(!g.pressed)return!0;e.preventDefault()}),r.editingArea.on("mouseup",".note-editable",function(t){var n=e("table.unselectable");if(n.toggleClass("unselectable",!1),n.attr("unselectable","off"),!g.pressed)return!0;o.invoke("beforeCommand"),F(e(this),g.contenteditable),N(),o.invoke("afterCommand")})}},a.initialize=function(){},a.destroy=function(){c.hideDialog(n),n.remove(),c.hideDialog(r),r.remove()}}}})})?n.apply(t,r):n)||(e.exports=a)}});